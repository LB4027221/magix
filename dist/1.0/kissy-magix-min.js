KISSY.add("magix/body",function(f,a,u,v){var j={},o=a.has,f=a.mix,s=a.listToMap("submit,focusin,focusout,mouseenter,mouseleave,mousewheel,change"),i=document.body,l={},q={},p=65536,k=function(a,c,h){h?a.setAttribute(c,h):h=a.getAttribute(c);return h},a=f({processEvent:function(a){for(var c=a.target||a.srcElement;c&&1!=c.nodeType;)c=c.parentNode;var h=c,g=a.type,m=q[g]||(q[g]=RegExp("(?:^|,)"+g+"(?:,|$)"));if(!m.test(k(c,"mx-ie"))){for(var d="mx-"+g,w,t,j=[];h&&h!=i&&!(w=k(h,d),t=k(h,"mx-ie"),w||m.test(t));)j.push(h),
h=h.parentNode;if(w){g=k(h,"mx-owner");if(!g){m=h;for(t=this.VOM.all();m&&m!=i;)if(o(t,m.id)){k(h,"mx-owner",g=m.id);break}else m=m.parentNode}if(g)this.fire("event",{info:w,se:a,tId:c.id||(c.id="mx-e-"+p--),cId:h.id||(h.id="mx-e-"+p--),hld:g});else throw Error("miss mx-owner:"+w);}else for(;j.length;)a=j.shift(),t=k(a,"mx-ie"),m.test(t)||(t=t?t+","+g:g,k(a,"mx-ie",t))}},attachEvent:function(a){var c=this;if(l[a])l[a]++;else if(l[a]=1,s[a])c.onUnbubble(i,a);else i["on"+a]=function(a){(a=a||window.event)&&
c.processEvent(a)}},detachEvent:function(a){var c=l[a];0<c&&(c--,c||(s[a]?this.offUnbubble(i,a):i["on"+a]=null),l[a]=c)}},u);a.onUnbubble=function(a,c){var h=this;v.delegate(a,c,"*[mx-"+c+"]",j[c]=function(a){h.processEvent(a)})};a.offUnbubble=function(a,c){v.undelegate(a,c,"*[mx-"+c+"]",j[c]);delete j[c]};return a},{requires:["magix/magix","magix/event","event"]});
KISSY.add("magix/event",function(f,a){var u=a.safeExec;return{fire:function(a,j,f,s){var i="~"+a,l=this[i];if(l){j||(j={});if(!j.type)j.type=a;for(var a=l.length,q=a-1,p,k;a--;)p=s?a:q-a,k=l[p],k.d&&(l.splice(p,1),q--),u(k,j,this)}f&&delete this[i]},on:function(f,j,o){f="~"+f;this[f]||(this[f]=[]);a.isNumeric(o)?this[f].splice(o,0,j):(j.d=o,this[f].push(j))},un:function(f,j){a.isArray(f)||(f=[f]);for(var o=0,s=f.length;o<s;o++){var i="~"+f[o],l=this[i];if(l)if(j)for(var i=0,q=l.length;i<q;i++){if(l[i]==
j){l.splice(i,1);break}}else delete this[i]}}}},{requires:["magix/magix"]});
KISSY.add("magix/magix",function(f){var a=[].slice,u=/\/\.\/|\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,v=/[^\/]*$/,j=/[#?].*$/,o=/([^=&?\/#]+)=([^&=#?]*)/g,s=/^https?:\/\//i,i={},l=0,q={debug:false,iniFile:"~/ini",appName:"app",appHome:"./",tagName:"vframe",rootId:"magix_vf_root"},p=i.hasOwnProperty,k=function(r){return function(a,b,e){switch(arguments.length){case 0:e=r;break;case 1:e=x.isObject(a)?g(r,a):h(r,a)?r[a]:null;break;case 2:null===b?(delete r[a],e=b):r[a]=e=b}return e}},n=function(r){this.c=
[];this.x=r||20;this.b=this.x+5},c=function(r){return new n(r)},h=function(r,a){return r?p.call(r,a):0},g=function(r,a,b){for(var e in a)if(!b||!h(b,e))r[e]=a[e];return r};g(n.prototype,{get:function(r){var a=this.c,b,r="pathname"+r;if(h(a,r)&&(b=a[r],1<=b.f))b.f++,b.t=l++,b=b.v;return b},set:function(a,g){var b=this.c,a="pathname"+a,e=b[a];if(!h(b,a)){if(b.length>=this.b){b.sort(function(b,e){return e.f==b.f?e.t-b.t:e.f-b.f});for(var d=this.b-this.x;d--;)e=b.pop(),delete b[e.k]}e={};b.push(e);b[a]=
e}e.k=a;e.v=g;e.f=1;e.t=l++;return e},del:function(a){var a="pathname"+a,g=this.c,b=g[a];if(b)b.f=-1E5,b.v="",delete g[a]},has:function(a){return h(this.c,"pathname"+a)}});var m=c(60),d=c(),w=function(a,g,b,e,d,c){x.isArray(a)||(a=[a]);if(!g||!x.isArray(g)&&!g.callee)g=[g];for(e=0;e<a.length;e++)try{c=a[e],d=x.isFunction(c)&&c.apply(b,g)}catch(m){}return d},t=function(){},x={isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},mix:g,has:h,safeExec:w,noop:t,config:k(q),start:function(a){var d=
this,a=g(q,a);d.libEnv(a);var b=a.iniFile.replace("~",a.appName);d.libRequire(b,function(b){q=g(a,b,a);var c=a.progress;d.libRequire(["magix/router","magix/vom"],function(b,e){b.on("changed",function(b){b.loc?e.locUpdated(b.loc):b.changed.isView()?e.mountRoot(b):e.locChanged(b)});e.on("progress",c||t);d.libRequire(a.extensions,function(){b.start()})})});a.ready&&(w(a.ready),delete a.ready)},keys:Object.keys||function(a){var g=[],b;for(b in a)h(a,b)&&g.push(b);return g},local:k({}),path:function(a,
g){var b=a+"\n"+g,e=d.get(b);if(!e){a=a.replace(j,"").replace(v,"");"/"==g.charAt(0)?(e=a.indexOf("://"),-1==e?e=g:(e=a.indexOf("/",e+3),e=-1==e?a+g:a.substring(0,e)+g)):e=a+g;for(;u.test(e);)e=e.replace(u,"$1/");d.set(b,e)}return e},pathToObject:function(a,g){var b=m.get(a);if(!b){var b={},e={},d="";j.test(a)?d=a.replace(j,""):~a.indexOf("=")||(d=a);if(d&&s.test(d))var c=d.indexOf("/",8),d=-1==c?"/":d.substring(c);a.replace(o,function(b,a,z){if(g)try{z=decodeURIComponent(z)}catch(d){}e[a]=z});b.pathname=
d;b.params=e;m.set(a,b)}return b},objectToPath:function(a,g){var b=a.pathname,e=[],d=a.params,c,m;for(m in d)c=d[m],g&&encodeURIComponent(c),e.push(m+"="+c);return b+(b&&e.length?"?":"")+e.join("&")},tmpl:function(a,g){return 1==arguments.length?{v:i[a],h:h(i,a)}:i[a]=g},listToMap:function(a,g){var b,e,d={},c;this.isString(a)&&(a=a.split(","));if(a&&(c=a.length))for(b=0;b<c;b++)e=a[b],d[g?e[g]:e]=g?e:1;return d},createCache:c};return g(x,{libRequire:function(g,d){if(g){var b=this.isFunction(d),e=
this.isArray(g);f.use(e?g.join(","):g,b?function(b){d.apply(b,a.call(arguments,1))}:this.noop)}else d()},libEnv:function(a){var g=a.appHome,b=location,e=b.protocol,d=a.appName;~g.indexOf(e)||(g=this.path(b.href,g));f.endsWith(g,"/")||(g+="/");a.appHome=g;var c=a.debug;c&&(c=0==g.indexOf(e+"//"+b.host));"~"==d.charAt(0)&&f.config({map:[[RegExp("/"+d+"/"),"/"]]});b="";(b=c?f.now():a.appTag)&&(b+=".js");e=a.appCombine;f.isUndefined(e)&&(e=f.config("combine"));f.config({packages:[{name:d,path:g,debug:a.debug=
c,combine:e,tag:b}]})},isArray:f.isArray,isFunction:f.isFunction,isObject:f.isObject,isRegExp:f.isRegExp,isString:f.isString,isNumber:f.isNumber})});
KISSY.add("magix/router",function(f,a,u,v){var j=window,o=a.has,s=a.mix,i=document,l=/^UTF-8$/i.test(i.charset||i.characterSet||"UTF-8"),q=a.config(),p=a.createCache(),k=a.createCache(),n,c,h,g=65536,m=/#.*$/,d=/^[^#]*#?!?/,w=q.nativeHistory,t,x,r=function(b,e,g){if(b){g=this.params;a.isArray(b)||(b=b.split(","));for(var d=0;d<b.length&&!(e=o(g,b[d]));d++);}return e},y=function(){return o(this,"pathname")},b=function(){return o(this,"view")},e=function(){return this.hash.pathname!=this.query.pathname},
C=function(a){return this.hash.params[a]!=this.query.params[a]},A=function(a){return o(this.hash.params,a)},B=function(a){return o(this.query.params,a)},D=function(a){return this.params[a]},f=s({getView:function(b){if(!h){h={routes:q.routes||{},e404:q.notFoundView};var e=q.defaultView;if(!e)throw Error("unset defaultView");h.home=e;var g=q.defaultPathname||"";h.routes[g]=e;h.pathname=g}b||(b=h.pathname);e=h.routes;e=a.isFunction(e)?e.call(q,b):e[b];return{view:e?e:h.e404||h.home,pathname:e?b:h.e404?
b:h.pathname}},start:function(){var a=j.history;t=w&&a.pushState;x=w&&!t;t?this.useState():this.useHash();this.route()},parsePath:function(b){var b=a.pathToObject(b,l),e=b.pathname;e&&"/"!=e.charAt(0)&&x&&(b.pathname=a.path(j.location.pathname,e));return b},parseQH:function(a){var a=a||j.location.href,b=p.get(a);if(!b){var b=a.replace(m,""),g=a.replace(d,""),c=this.parsePath(b),h=this.parsePath(g),f={};s(f,c.params);s(f,h.params);b={pathnameDiff:e,paramDiff:C,hashOwn:A,queryOwn:B,get:D,href:a,srcQuery:b,
srcHash:g,query:c,hash:h,params:f};p.set(a,b)}return b},parseLoc:function(a){a=this.parseQH(a);if(!a.view){var b=this.getView(w?a.hash.pathname||a.query.pathname:a.hash.pathname);s(a,b)}return a},getChged:function(a,e){var g=e.href,d=a.href+"\n"+g,c=k.get(d);c||(d=g+"\n"+d,c=k.get(d));if(!c){var m,c={params:{}};if(a.pathname!=e.pathname)m=c.pathname=1;if(a.view!=e.view)m=c.view=1;var g=a.params,h=e.params,f;for(f in g)g[f]!=h[f]&&(m=1,c.params[f]=1);for(f in h)g[f]!=h[f]&&(m=1,c.params[f]=1);c.occur=
m;c.isParam=r;c.isPathname=y;c.isView=b;k.set(d,c)}return c},route:function(){var a=this.parseLoc(),b=c||{params:{},href:"~"},e=!c;c=a;b=this.getChged(b,a);b.occur&&(n=a,this.fire("changed",{location:a,changed:b,force:e}))},navigate2:function(b){if(b&&a.isString(b)){var e=this.parsePath(b),b={};b.params=s({},e.params);b.pathname=e.pathname;if(b.pathname){if(x&&(e=n.query)&&(e=e.params))for(var d in e)o(e,d)&&!o(b.params,d)&&(b.params[d]="")}else d=s({},n.params),b.params=s(d,b.params),b.pathname=
n.pathname;d=a.objectToPath(b);if(t?d!=n.srcQuery:d!=n.srcHash)t?(this.$firedPop=1,history.pushState(g--,i.title,d),this.route()):(s(b,n,b),b.srcHash=d,b.hash={params:b.params,pathname:b.pathname},this.fire("changed",{loc:n=b}),location.hash="#!"+d)}},navigate:function(b,e){!e&&a.isObject(b)&&(e=b,b="");e&&(b=a.objectToPath({params:e,pathname:b},l));this.navigate2(b)}},u);f.useState=function(){var b=this,a=location.href;v.on(j,"popstate",function(){var e=location.href==a;if(b.$firedPop||!e)b.$firedPop=
!0,b.route()})};f.useHash=function(){var b=this;v.on(j,"hashchange",function(){b.route()})};return f},{requires:["magix/magix","magix/event","event"]});
KISSY.add("magix/vframe",function(f,a,u,v){var j=document,o=65536,s=window.CollectGarbage||a.noop,i=a.mix,f=a.config(),l=f.tagName,q=f.rootId,p=a.has,k,n=function(a){return"object"==typeof a?a:j.getElementById(a)};j.createElement(l);var c=/<script[^>]*>[\s\S]*?<\/script>/ig,h=function(a){this.id=a;this.vId=a+"_v";this.cM={};this.rC=this.cC=0;this.sign=-2147483648;this.rM={}};i(h,{root:function(a){if(!k){var c=n(q);if(!c)c=j.createElement(l),c.id=q,j.body.insertBefore(c,j.body.firstChild);k=new h(q);
a.add(k)}return k}});i(i(h.prototype,u),{useAnimUpdate:a.noop,oldViewDestroy:a.noop,prepareNextView:a.noop,newViewCreated:a.noop,mountView:function(g,m){var d=this,f=n(d.id);f._bak?f._chgd=1:(f._bak=1,f._tmpl=f.innerHTML.replace(c,""));var h=d.viewUsable&&d.useAnimUpdate();d.unmountView(h,1);if(g){var j=a.pathToObject(g),r=j.pathname,l=--d.sign;a.libRequire(r,function(b){if(l==d.sign){var a=d.owner;v.prepare(b,{$:n,path:r,vom:a});var g;h?(g=d.vId,d.prepareNextView()):g=d.id;var c=new b({owner:d,id:g,
vId:d.vId,vfId:d.id,location:a.getLoc()});d.view=c;c.on("interact",function(b){d.fire("viewInteract",{view:c});d.viewUsable=1;h&&d.newViewCreated(1);if(!b.tmpl){if(!h&&f._chgd)f.innerHTML=f._tmpl;d.mountZoneVframes(0,0,1)}c.on("rendered",function(){d.mountZoneVframes(0,0,1)});c.on("prerender",function(b){d.unmountZoneVframes(0,b.anim)})},0);m=m||{};c.load(i(m,j.params,m))}})}},unmountView:function(a,c){if(this.view){this.unmountZoneVframes(0,a);this.childrenAlter({});this.view.destroy();var d=n(this.id);
if(!a&&d._bak)d.innerHTML=d._tmpl;a&&c&&this.oldViewDestroy();delete this.view;delete this.viewUsable;this.fire("viewUnmounted");s()}this.un("viewInteract");this.sign--},mountVframe:function(a,c,d,f){var j=this.owner,i=j.get(a);if(!i)i=new h(a),i.pId=this.id,p(this.cM,a)||this.cC++,this.cM[a]=f,j.add(i);i.mountView(c,d);return i},mountZoneVframes:function(a,c,d){this.unmountZoneVframes(a);var a=a?a:n(this.vId)||n(this.id),a=n(a).getElementsByTagName(l),f=a.length,h={};if(f)for(var j=0,i,k,b,e;j<f;j++){i=
a[j];k=i.id||(i.id="magix_vf_"+o--);p(h,k)||(b=i.getAttribute("mx-view"),e=i.getAttribute("mx-defer"),(!e||b)&&this.mountVframe(k,b,c,d));i=n(i).getElementsByTagName(l);k=0;for(b=i.length;k<b;k++)h[i[k].id||(i[k].id="magix_vf_"+o--)]=1}this.cC==this.rC&&this.childrenCreated({})},unmountVframe:function(a,c){var a=a||this.id,d=this.owner,f=d.get(a);if(f){var h=f.fcc;f.unmountView(c);d.remove(a,h);if((d=d.get(f.pId))&&p(d.cM,a))delete d.cM[a],d.cC--}},unmountZoneVframes:function(a){if(a){for(var a=n(a).getElementsByTagName(l),
c={},d=this.cM,f=a.length-1,h;0<=f;f--)h=a[f].id,p(d,h)&&(c[h]=1);a=c}else a=this.cM;for(var i in a)this.unmountVframe(i)},childrenCreated:function(a){var c=this.view;if(c&&!this.fcc)this.fcc=1,delete this.fca,c.fire("created",a),this.fire("created",a);var d=this.owner;d.childCreated();c=this.id;if((d=d.get(this.pId))&&!p(d.rM,c))d.rM[c]=d.cM[c],d.rC++,d.rC==d.cC&&d.childrenCreated(a)},childrenAlter:function(a){delete this.fcc;if(!this.fca){var c=this.view,d=this.id;if(c)this.fca=1,c.fire("alter",
a),this.fire("alter",a);if((c=this.owner.get(this.pId))&&p(c.rM,d)){var f=c.rM[d];c.rC--;delete c.rM[d];f&&c.childrenAlter(a)}}},locationChanged:function(c,f){var d=this.view;if(d&&d.sign&&(d.location=c,d.rendered)){var h=d.olChanged(f),i={location:c,changed:f,prevent:function(){this.cs=[]},toChildren:function(c){c=c||[];a.isString(c)&&(c=c.split(","));this.cs=c}};h&&a.safeExec(d.locationChange,i,d);for(var d=i.cs||a.keys(this.cM),h=0,i=d.length,j=this.owner,k;h<i;h++)(k=j.get(d[h]))&&k.locationChanged(c,
f)}},locationUpdated:function(a){var c=this.view;if(c&&c.sign){c.location=a;var c=this.cM,d,f=this.owner,h;for(h in c)(d=f.get(h))&&d.locationUpdated(a)}}});return h},{requires:["magix/magix","magix/event","magix/view"]});
KISSY.add("magix/view",function(f,a,u,v,j){var o=f.Env.mods,s={wrapAsyn:1,extend:1},i=function(b,e,c){for(var d in e)f.isObject(e[d])?(a.has(b,d)||(b[d]={}),i(b[d],e[d],!0)):c&&(b[d]=e[d])},l=a.safeExec,q=a.has,p=[],k=a.config(),n=/^~[^\/]*/,c=a.mix,h=a.listToMap("render,renderUI"),g=function(a){return function(){var e;this.sign&&(this.sign++,this.fire("rendercall"),e=a.apply(this,arguments));return e}},m=function(a){c(this,a);this.sign=1};c(m,{wrapAsyn:function(){if(!this["~~"]){this["~~"]=1;var b=
this.prototype,e,c;for(c in b){e=b[c];var d=null;a.isFunction(e)&&e!=a.noop&&!e["~~"]&&q(h,c)&&(d=g(e),d["~~"]=e,b[c]=d)}}}});var d=m.prototype,w=window.CollectGarbage||a.noop,t=/\smx-[^ohv][a-z]+\s*=/g,x={prevent:function(a){a=a||this.domEvent;a.preventDefault?a.preventDefault():a.returnValue=!1},stop:function(a){a=a||this.domEvent;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},halt:function(a){this.prevent(a);this.stop(a)}},r=/(\w+)(?:<(\w+)>)?(?:{([\s\S]*)})?/,y=/(\w+):([^,]+)/g;c(d,
u);c(d,{render:a.noop,locationChange:a.noop,init:a.noop,hasTmpl:!0,enableEvent:!0,enableAnim:!1,load:function(){var a=this,e=a.hasTmpl,c=arguments,d=a.sign,f=function(){if(d==a.sign&&(a.delegateEvents(),a.fire("interact",{tmpl:e},1),l(a.init,c,a),l(a.render,p,a),!e&&!a.rendered))a.rendered=!0,a.fire("primed",null,1)};e&&!q(a,"template")?a.planTmpl(f):f()},updateViewId:function(){this.id=this.$(this.vId)?this.vId:this.vfId},beginUpdateHTML:function(){if(this.sign&&this.rendered){var a=this.enableAnim;
this.fire("refresh",0,1);this.fire("prerender",{anim:a});var e=this.owner;a&&(l(e.oldViewDestroy,p,e),l(e.prepareNextView,p,e),this.updateViewId())}},endUpdateHTML:function(){if(this.sign){if(this.rendered&&this.enableAnim){var a=this.owner;l(a.newViewCreated,p,a)}this.rendered||this.fire("primed",null,1);this.rendered=!0;this.fire("rendered");w()}},wrapMxEvent:function(a){return a?(""+a).replace(t,' mx-owner="'+this.vfId+'"$&'):a},setViewHTML:function(a){this.beginUpdateHTML();if(this.sign)this.$(this.id).innerHTML=
this.wrapMxEvent(a);this.endUpdateHTML()},observeLocation:function(b){var e;if(!this.$ol)this.$ol={keys:[]};e=this.$ol;var c=e.keys;if(a.isObject(b))e.pn=b.pathname,b=b.keys;if(b)e.keys=c.concat(a.isString(b)?b.split(","):b)},olChanged:function(a){var e=this.$ol;if(e){var c=0;e.pn&&(c=a.isPathname());c||(c=a.isParam(e.keys));return c}return 1},destroy:function(){this.fire("refresh",0,1);this.fire("destroy",0,1,1);this.delegateEvents(1);this.sign=0},parentView:function(){var a=this.vom.get(this.owner.pId),
c=null;if(a&&a.viewUsable)c=a.view;return c},planTmpl:function(b){var c=this,d=a.tmpl(c.path);d.h?(c.template=d.v,b()):(d=c.home+c.path.replace(n,"")+".html",c.fetchTmpl(d,function(d){c.template=a.tmpl(c.path,d);b()},k.debug))},processEvent:function(a){if(this.enableEvent&&this.sign){var e=a.se,d=a.info.match(r),f=d[1],g=d[2],d=d[3],h=this.events;if(h){var i=h[e.type];if(x[g])x[g](e);if(i&&i[f]){var j={};d&&d.replace(y,function(a,b,c){j[b]=c});l(i[f],c({view:this,currentId:a.cId,targetId:a.tId,domEvent:e,
events:h,params:j},x),i)}}}},delegateEvents:function(a){var c=this.events,a=a?v.detachEvent:v.attachEvent,d;for(d in c)a.call(v,d)}});m.prototype.fetchTmpl=function(b,c,d){var g=i[b];g?g.push(c):(g=i[b]=[c],j({url:b+(d?"?_="+f.now():""),success:function(c){a.safeExec(g,c);delete i[b]},error:function(a,b){c(b)}}))};m.extend=function(b,c){var d=function(){d.superclass.constructor.apply(this,arguments);c&&a.safeExec(c,arguments,this)};d.extend=this.extend;return f.extend(d,this,b)};m.prepare=function(c,
d){if(!c.wrapAsyn){for(var f in this)a.has(s,f)&&(c[f]=this[f]);f=c.prototype;for(var g=c;g.superclass;)g=g.superclass.constructor,i(f,g.prototype);d.home=o[d.path].packageInfo.getBase();a.mix(f,d)}c.wrapAsyn()};return m},{requires:["magix/magix","magix/event","magix/body","ajax"]});
KISSY.add("magix/vom",function(f,a,u,v,j){var o=u.has,s=0,i=0,l=0,q=0,p={},k,n=u.mix({all:function(){return p},add:function(a){if(!o(p,a.id))s++,p[a.id]=a,a.owner=n,n.fire("add",{vframe:a})},get:function(a){return p[a]},remove:function(a,f){var g=p[a];g&&(s--,f&&i--,delete p[a],n.fire("remove",{vframe:g}))},childCreated:function(){if(!q){i++;var a=i/s;l<a&&(n.fire("progress",{percent:l=a}),1==a&&(q=1,n.un("progress")))}},root:function(){return a.root(n)},mountRoot:function(a){var f=n.root();k=a.location;
f.mountView(k.view)},locChanged:function(a){k=a.location;n.root().locationChanged(k,a.changed)},locUpdated:function(a){k=a;n.root().locationUpdated(a)},getLoc:function(){return k}},v);j.VOM=n;j.on("event",function(a){var f=n.get(a.hld);(f=f&&f.view)&&f.processEvent(a)});return n},{requires:["magix/vframe","magix/magix","magix/event","magix/body"]});
(function(f){var a=function(){};if(!f.console)f.console={log:a,info:a,error:a};var u,v={};if(!f.Magix)f.Magix={config:function(a){for(var f in a)v[f]=a[f]},start:function(a){u=a}},KISSY.use("magix/magix",function(a,o){f.Magix=o;o.config(v);u&&o.start(u)})})(this);