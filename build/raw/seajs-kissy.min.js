define("magix/ajax",["magix/impls/ajax","magix/base"],function(a){var b=a("magix/impls/ajax"),a=a("magix/base");eval(a.include("tmpls/ajax"));return a.implement(void 0,b)});
define("magix/base",["magix/impls/base"],function(a){var a=a("magix/impls/base"),b={mix:function(a,h,c,b){if(!h||!a)return a;void 0===c&&(c=!0);var g,e,i;if(b&&(i=b.length))for(g=0;g<i;g++){if(e=b[g],e in h&&(c||!(e in a)))a[e]=h[e]}else for(e in h)if(c||!(e in a))a[e]=h[e];return a},include:function(a){var a=Magix.config.magixHome+"../"+a+".js?r="+Math.random(),b=new (window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");b.open("GET",a,!1);b.send(null);return b.responseText},unimpl:function(){throw Error("unimplement method");
}};eval(b.include("tmpls/base"));b.mix(b,a);return b});define("magix/impls/ajax",function(){var a=KISSY,b={},d;a.use("ajax",function(a,b){d=b});b.send=function(b){var c=this,b=this.processOptions(b),f=b.success,g=b.error;d(a.mix(b,{url:b.url,dataType:b.dataType,type:b.method,success:function(a,g,d){c.fireGlobalSetting(d);f.call(b,a)},error:function(a,d,f){c.fireGlobalSetting(f);g.call(b,d)}}))};return b});
define("magix/impls/base",function(a){var b=Object.prototype.toString;return{isFunction:function(a){return"[object Function]"===b.call(a)},isArray:function(a){return"[object Array]"===b.call(a)},isString:function(a){return"[object String]"===b.call(a)},isPlainObject:function(a){return a&&"[object Object]"===b.call(a)&&!a.nodeType&&!a.setInterval},requireAsync:function(b,h){a.async(b,h)},Events:{bind:function(a,b,c){var f=this._callbacks||(this._callbacks={});(f[a]||(f[a]=[])).push([b,c]);return this},
unbind:function(a,b){var c;if(a){if(c=this._callbacks)if(b){c=c[a];if(!c)return this;for(var f=0,g=c.length;f<g;f++)if(c[f]&&b===c[f][0]){c[f]=null;break}}else c[a]=[]}else this._callbacks={};return this},trigger:function(a){var b,c,f,g,e=2;if(!(c=this._callbacks))return this;for(;e--;)if(b=e?a:"all",b=c[b])for(var i=0,j=b.length;i<j;i++)(f=b[i])?(g=e?Array.prototype.slice.call(arguments,1):arguments,f[0].apply(f[1]||this,g)):(b.splice(i,1),i--,j--);return this}}}});
define("magix/impls/model",["magix/base"],function(a){var b=KISSY,a=a("magix/base"),d;b.use("mvc",function(a,b){d=b.Model});b.mix(d.prototype,a.Events);var h=d.prototype.fire;d.prototype.fire=function(a,b){h(a,b);"*"==a.charAt(0)&&(a=a.substring(1).replace(/[A-Z]/,function(a){return a.toLowerCase()}));this.trigger(a,b)};d.prototype.unset=function(a){this.removeAttr(a)};d.prototype.clear=function(){var a=this.toJSON(),b;for(b in a)this.removeAttr(b)};return d});
define("magix/impls/router",["magix/base","magix/model","magix/vom","app/config/ini"],function(a){var b=a("magix/base"),d=a("magix/model"),h=a("magix/vom"),c=a("app/config/ini"),f;KISSY.use("mvc",function(a,b){f=b});return{getAppConfig:function(){var a=c.pathViewMap;if(c.defaultViewName)for(var b in a)if(!a[b])a[b]=c.defaultViewName;return c},getVOMObject:function(){return h},setStateListener:function(){var a=this;(new f.Router).addRoutes({"*hash":function(b){KISSY.log(b.hash);a.route(b.hash)}});
f.Router.start({triggerRoute:1,urlRoot:location.href.split("#")[0].split("index.html")[0]})},parseState:function(a){return this._parseHash(a)},_parseHash:function(a){var e={},c;e.pathName=this.appConfig.indexPath;e.paraObj={};e.referrer=this.state&&this.state.query||null;if(e.query=a)a=a.split("/"),c=a.pop(),e.pathName=a.join("/"),e.paraObj=b.unParam(c);return e},parseSearch:function(){return this._parseSearch()},_parseSearch:function(){var a={},e=this.config.pathPrefix||null;a.pathName=location.pathname;
a.paraObj={};if(e)a.pathName=location.pathname.split(e)[1];a.query=a.pathName+location.search;if(location.search)a.paraObj=b.unParam(location.search.substr(1));return a},getRootViewName:function(){var a=this.appConfig.pathViewMap,b;b=a[this.query.pathname]?a[this.query.pathname]:a[this.appConfig.notFoundPath];this.query.__view__&&(b=this.query.__view__.split("-").join("/"));if(this.config.multipage)a=a[this.query["sch:pathname"]],"object"==typeof a?b=a[this.query.pathname]||a[this.appConfig.notFoundPath]:
(document.body.id="vc-root",b=a||this.appConfig.defaultRootViewName);return b},createQueryModel:function(){return new d(this.query)},changeQueryModel:function(){this._fixQueryModel(this.query);this.queryModel.set(this.query)},_fixQueryModel:function(a){if(this.queryModel){var b,c=this.queryModel.toJSON();for(b in c)b in a||this.queryModel.unset(b,{silent:!0})}},navigateTo:function(a){var a=b.unParam(a),c=S.clone(this.state.paraObj);delete c.referrer;delete c.pathname;delete c.query;delete c.postdata;
var a=b.mix(c,a),d;for(d in a)a[d]||delete a[d];this.goTo(this.state.pathName+"/"+b.param(a))}}});define("magix/impls/template",function(){var a={},b;KISSY.use("template",function(a,h){b=h});a.toHTML=function(a){a=this.processOptions(a);return b(a.template).render(a.data)};return a});
define("magix/impls/vframe",["magix/base"],function(a){var b=a("magix/base"),d=function(){};b.mix(d,{tagName:"vframe"});b.mix(d.prototype,{getChildVframeNodes:function(){var a=document.getElementById(this.id).getElementsByTagName("vframe"),b,d=[];for(b=0;b<a.length;b++)d.push(this._idIt(a[b]));return d},getRouterObject:function(){var b;a.async("magix/router",function(a){b=a});return b},getVOMObject:function(){var b;a.async("magix/vom",function(a){b=a});return b},createFrame:function(){return document.createElement(d.tagName)}});
return d});
define("magix/impls/view",["magix/vom","magix/ajax","magix/template","magix/base"],function(a){var b=a("magix/vom"),d=a("magix/base"),h=a("magix/ajax"),c=a("magix/template"),a=KISSY,f;a.use("mvc",function(a,b){f=b});var g=function(){g.superclass.constructor.apply(this,arguments)};a.extend(g,f.View,{initial:function(){this.delegateEvents()},getVOMObject:function(){return b},getAjaxObject:function(){return h},getTemplateObject:function(){return c},dispose:function(){g.superclass.destroy.apply(this,arguments)}});
a.mix(g.prototype,d.Events);var e=g.prototype.fire;g.prototype.fire=function(a,b){e(a,b);this.trigger(a,b)};return g});define("magix/impls/vom",["magix/base"],function(a){a("magix/base");return{setRootVframe:function(){var a=null;if("vf-root"==document.body.id)a=document.body;var d=this.createElement(a,"vf-root");a||document.body.insertBefore(d.getOnce(),document.body.firstChild);this.root=d}}});
Magix={init:function(a){this.config=a;this.setEnv();this.bootstrap()},setEnv:function(){var a={magix:this.config.magixHome,app:this.config.appHome};if(a.magix&&!/\/$/.test(a.magix))a.magix+="/",this.config.magixHome=a.magix;if(a.app&&!/\/$/.test(a.app))a.app+="/",this.config.appHome=a.app;if(this.config.debug)this.dev=!0;this.dev?seajs.config({debug:2}):delete a.magix;seajs.config({alias:a})},bootstrap:function(){var a=this;KISSY.use(["mvc","ajax","template"],function(){seajs.use(["magix/router"],
function(b){b.init(a.config)})})},implementBy:"seajs-kissy",version:"0.1.0",dev:""};define("magix/model",["magix/impls/model","magix/base"],function(a){var b=a("magix/impls/model"),a=a("magix/base");eval(a.include("tmpls/model"));return a.implement(void 0,b)});define("magix/router",["magix/impls/router","magix/base"],function(a){var b=a("magix/impls/router"),a=a("magix/base");eval(a.include("tmpls/router"));return a.implement({},b)});
define("magix/template",["magix/impls/template","magix/base"],function(a){var b=a("magix/impls/template"),a=a("magix/base");eval(a.include("tmpls/template"));return a.implement(void 0,b)});define("magix/vframe",["magix/impls/vframe","magix/base"],function(a){var b=a("magix/base"),a=a("magix/impls/vframe");eval(b.include("tmpls/vframe"));return b.implement(void 0,a).init()});
define("magix/view",["magix/impls/view","magix/base"],function(a){var b=a("magix/impls/view"),a=a("magix/base");eval(a.include("tmpls/view"));return a.implement(void 0,b)});define("magix/vom",["magix/impls/vom","magix/base","magix/vframe"],function(a){var b=a("magix/impls/vom"),d=a("magix/base");a("magix/vframe");eval(d.include("tmpls/vom"));return d.implement({},b).init()});