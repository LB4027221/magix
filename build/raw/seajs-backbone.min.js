define("magix/ajax",["magix/impls/ajax","magix/base"],function(a){var b=a("magix/impls/ajax"),a=a("magix/base");eval(a.include("tmpls/ajax"));return a.implement(void 0,b)});
define("magix/base",["magix/impls/base"],function(a){var a=a("magix/impls/base"),b={mix:function(a,f,b,g){if(!f||!a)return a;void 0===b&&(b=!0);var i,c,e;if(g&&(e=g.length))for(i=0;i<e;i++){if(c=g[i],c in f&&(b||!(c in a)))a[c]=f[c]}else for(c in f)if(b||!(c in a))a[c]=f[c];return a},include:function(a){var a=Magix.config.magixHome+"../"+a+".js?r="+Math.random(),b=new (window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");b.open("GET",a,!1);b.send(null);return b.responseText},unimpl:function(){throw Error("unimplement method");
}};eval(b.include("tmpls/base"));b.mix(b,a);return b});define("magix/impls/ajax",["jquery"],function(a){var b={},d=a("jquery");b.send=function(a){var b=this,a=b.processOptions(a),g=a.success,i=a.error;d.ajax(Base.mix(a,{url:a.url,dataType:a.dataType,type:a.method,success:function(c,i,d){b.fireGlobalSetting(d);g.call(a,c)},error:function(c,e){b.fireGlobalSetting(c);i.call(a,e)}}))};return b});
define("magix/impls/base",["backbone"],function(a){var b=a("backbone"),d=Object.prototype.toString;return{isFunction:function(a){return"[object Function]"===d.call(a)},isArray:function(a){return"[object Array]"===d.call(a)},isString:function(a){return"[object String]"===d.call(a)},isPlainObject:function(a){return a&&"[object Object]"===d.call(a)&&!a.nodeType&&!a.setInterval},requireAsync:function(b,d){a.async(b,d)},Events:b.Events}});
define("magix/impls/model",["backbone"],function(a){a=a("backbone").Model;a.prototype.load=function(){this.fetch.apply(this,arguments)};return a});
define("magix/impls/router",["magix/base","magix/model","magix/vom","app/config/ini","underscore"],function(a){var b=a("magix/base"),d=a("magix/model"),f=a("magix/vom"),j=a("app/config/ini"),g=a("underscore");return{getAppConfig:function(){var a=j.pathViewMap;if(j.defaultViewName)for(var c in a)if(!a[c])a[c]=j.defaultViewName;return j},getVOMObject:function(){return f},setStateListener:function(){var a=this;MxHistory.setHashListener(function(c){a.route(c)})},parseState:function(a){return this._parseHash(a)},
_parseHash:function(a){var c={},e;c.pathName=this.appConfig.indexPath;c.paraObj={};c.referrer=this.state&&this.state.query||null;if(c.query=a)a=a.split("/"),e=a.pop(),c.pathName=a.join("/"),c.paraObj=b.unParam(e);return c},parseSearch:function(){return this._parseSearch()},_parseSearch:function(){var a={},c=this.config.pathPrefix||null;a.pathName=location.pathname;a.paraObj={};if(c)a.pathName=location.pathname.split(c)[1];a.query=a.pathName+location.search;if(location.search)a.paraObj=b.unParam(location.search.substr(1));
return a},getRootViewName:function(){var a=this.appConfig.pathViewMap,c;c=a[this.query.pathname]?a[this.query.pathname]:a[this.appConfig.notFoundPath];this.query.__view__&&(c=this.query.__view__.split("-").join("/"));if(this.config.multipage)a=a[this.query["sch:pathname"]],"object"==typeof a?c=a[this.query.pathname]||a[this.appConfig.notFoundPath]:(document.body.id="vc-root",c=a||this.appConfig.defaultRootViewName);return c},createQueryModel:function(){return new d(this.query)},changeQueryModel:function(){this._fixQueryModel(this.query);
this.queryModel.set(this.query)},_fixQueryModel:function(a){if(this.queryModel){var c,b=this.queryModel.toJSON();for(c in b)c in a||this.queryModel.unset(c,{silent:!0})}},navigateTo:function(a){var a=b.unParam(a),c=g.clone(this.state.paraObj);delete c.referrer;delete c.pathname;delete c.query;delete c.postdata;var a=g.extend(c,a),e;for(e in a)a[e]||delete a[e];this.goTo(this.state.pathName+"/"+b.param(a))}}});
define("magix/impls/template",["magix/mu"],function(a){var b={},d=a("magix/mu");b.toHTML=function(a){a=this.processOptions(a);return d.to_html(a.template,a.data)};return b});
define("magix/impls/vframe",["magix/base"],function(a){var b=a("magix/base"),d=function(){};b.mix(d,{tagName:"vframe"});b.mix(d.prototype,{getChildVframeNodes:function(){var a=document.getElementById(this.id).getElementsByTagName("vframe"),b,d=[];for(b=0;b<a.length;b++)d.push(this._idIt(a[b]));return d},getRouterObject:function(){var b;a.async("magix/router",function(a){b=a});return b},getVOMObject:function(){var b;a.async("magix/vom",function(a){b=a});return b},createFrame:function(){return document.createElement(d.tagName)}});
return d});define("magix/impls/view",["backbone","magix/vom","magix/ajax","magix/template"],function(a){var b=a("magix/vom"),d=a("magix/ajax"),f=a("backbone"),j=a("magix/template");return f.View.extend({getVOMObject:function(){return b},getAjaxObject:function(){return d},getTemplateObject:function(){return j},dispose:function(){}})});
define("magix/impls/vom",["magix/base"],function(a){a("magix/base");return{setRootVframe:function(){var a=null;if("vf-root"==document.body.id)a=document.body;var d=this.createElement(a,"vf-root");a||document.body.insertBefore(d.getOnce(),document.body.firstChild);this.root=d}}});
Magix={init:function(a){this.config=a;this.setEnv();this.bootstrap()},setEnv:function(){var a={magix:this.config.magixHome,app:this.config.appHome};if(a.magix&&!/\/$/.test(a.magix))a.magix+="/",this.config.magixHome=a.magix;if(a.app&&!/\/$/.test(a.app))a.app+="/",this.config.appHome=a.app;if(this.config.debug)this.dev=!0;this.dev?seajs.config({debug:2}):delete a.magix;seajs.config({alias:a});MxHistory&&MxHistory.init&&MxHistory.init(this.config)},bootstrap:function(){var a=this;seajs.use(["magix/router"],
function(b){b.init(a.config)})},implementBy:"seajs-backbone-jquery",version:"0.3.0",dev:""};define("magix/model",["magix/impls/model","magix/base"],function(a){var b=a("magix/impls/model"),a=a("magix/base");eval(a.include("tmpls/model"));return a.implement(void 0,b)});
define("magix/mu",["mustache"],function(a){function b(a){a=a.split("==");return function(){for(var b=a[0].split("."),d=a[1],c=b.length-1;-1<c;c--){var e=b.slice(c),h=this;try{for(var f=0;f<e.length-1;f++)h=h[e[f]];if(e[e.length-1]in h){if(h[e[e.length-1]].toString()===d)return!0;break}}catch(l){}}return!1}}function d(a,b){var f,c;for(f in a)if(c=a[f],c instanceof Array)for(var e=0;e<c.length;e++){if(o=c[e],"object"==typeof o)0===e?o.__first__=!0:e==c.length-1?o.__last__=!0:o.__mid__=!0,o.__index__=
e}else"object"==typeof c&&5>b&&d(c,b+1)}var f=a("mustache");return{to_html:function(a,g){"object"==typeof g&&d(g,0);var i=g,c;c=/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/i;var e=a.match(/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/ig),h=[];if(e)for(var k=0;k<e.length;k++)h.push(e[k].match(c)[1]);c=h;e="";for(h=0;h<c.length;h++)e="if("+c[h]+")",i[e]||(i[e]=b(c[h]));return f.to_html.apply(this,arguments)}}});if(!window.console)window.console={log:function(){},dir:function(){},warn:function(){},error:function(){}};
MxHistory={config:{},hash:"",oldHash:null,showIframe:!1,isIE:!1,iframe:null,slient:!1,interval:50,intervalId:0,iframeSrc:"",ready:!1,hashListener:null,currentHash:"",init:function(a){a=a||{};this.iframeSrc=a.iframeSrc||"mxhistory.html";this.config=a;this.oldHash=this.hash=location.hash;this.isIE=-1<navigator.userAgent.toLowerCase().indexOf("msie");a=document.documentMode;this.showIframe=this.isIE&&(!a||8>a);this.wirteFrame(this.iframeSrc);this.regHashChange();this.showIframe||this.route(this.hash)},
regHashChange:function(){var a=this;"onhashchange"in window&&!this.showIframe?window.onhashchange=function(){a.hashChange.call(a)}:this.intervalId=window.setInterval(function(){location.hash!=a.oldHash&&a.hashChange.call(a)},this.interval)},hashChange:function(){this.oldHash=this.hash=location.hash;this.showIframe?this.iframe.src=this.iframeSrc+"?"+(this.hash?this.hash.substr(1):""):this.route(this.hash)},frameLoad:function(){var a=Magix.History;if(a.iframe){var b=a.iframe.contentWindow.location.search.substr(1);
a.hash=a.oldHash="#"+b;location.hash=b}this.route(this.hash)},route:function(a){0===a.indexOf("?")&&(a=a.substr(1));0===a.indexOf("#")&&(a=a.substr(1));0===a.indexOf("!")&&(a=a.substr(1));this.hashListener&&this.hashListener(a);this.ready=!0;this.currentHash=a},wirteFrame:function(){var a=this;this.showIframe&&document.write("<iframe onload='Magix.History.frameLoad();' id='MxHistory' src='"+this.iframeSrc+"?"+(this.hash?this.hash.substr(1):"")+"' style='z-index:99998;visibility:hidden;position:absolute;' border='0' frameborder='0' marginwidth='0' marginheight='0' scrolling='no' ></iframe>");
window.setTimeout(function(){a.iframe=document.getElementById("MxHistory")},0)},setHashListener:function(a){this.hashListener=a;this.ready&&a(this.currentHash)}};define("magix/router",["magix/impls/router","magix/base"],function(a){var b=a("magix/impls/router"),a=a("magix/base");eval(a.include("tmpls/router"));return a.implement({},b)});
define("magix/template",["magix/impls/template","magix/base"],function(a){var b=a("magix/impls/template"),a=a("magix/base");eval(a.include("tmpls/template"));return a.implement(void 0,b)});define("magix/vframe",["magix/impls/vframe","magix/base"],function(a){var b=a("magix/base"),a=a("magix/impls/vframe");eval(b.include("tmpls/vframe"));return b.implement(void 0,a).init()});
define("magix/view",["magix/impls/view","magix/base"],function(a){var b=a("magix/impls/view"),a=a("magix/base");eval(a.include("tmpls/view"));return a.implement(void 0,b)});define("magix/vom",["magix/impls/vom","magix/base","magix/vframe"],function(a){var b=a("magix/impls/vom"),d=a("magix/base");a("magix/vframe");eval(d.include("tmpls/vom"));return d.implement({},b).init()});