KISSY.add("magix/event",function(h,f){var e=f.safeExec;return{trigger:function(a,c,b,d){var i="~~"+a+"_list",g=this[i];if(g){c||(c={});if(!c.type)c.type=a;if(d)for(a=g.length-1;0<=a&&!(!1===e(g[a],c,this));a--);else{a=0;for(d=g.length;a<d&&!(!1===e(g[a],c,this));a++);}}b&&delete this[i]},bind:function(a,c){var b="~~"+a+"_list";this[b]||(this[b]=[]);this[b].push(c)},unbind:function(a,c){var b="~~"+a+"_list",d=this[b];if(d)if(c)for(var b=0,e=d.length;b<e;b++){if(d[b]==c){d.splice(b,1);break}}else delete this[b]}}},
{requires:["magix/magix"]});
KISSY.add("magix/impl/magix",function(h){return{include:function(f){var f=h.Config.packages.magix.path+f+".js?r="+Math.random()+".js",e=new (window.ActiveXObject||window.XMLHttpRequest)("Microsoft.XMLHTTP");e.open("GET",f,!1);e.send(null);return e.responseText},libRequire:function(f,e){h.use(f,function(a,c){e(c)})},libEnv:function(){var f=this.config(),e=f.appHome;if(!e)throw Error("please set appHome");e=e.replace(/(^|\/)app\/?/i,function(c,b){return b||"./"});f.appHome=e;if(!f.release&&/^https?:\/\//.test(e))f.release=
-1==e.indexOf(location.protocol+"//"+location.host);f.release||h.config({map:[[RegExp("("+e+".+)-min\\.js(\\?[^?]+)?"),"$1.js$2"]]});var a="";(a=f.release?f.appTag:h.now())&&(a+=".js");h.config({packages:[{name:"app",path:e,tag:a}]});f.viewChangeAnim&&h.Env.mods["mxext/vfanim"]&&h.use("mxext/vfanim")},isArray:h.isArray,isFunction:h.isFunction,isObject:h.isObject,isRegExp:h.isRegExp,isString:h.isString,isNumber:h.isNumber}});
KISSY.add("magix/impl/router",function(h){return{useHistoryState:function(){var f=this,e=location.href;h.one(window).on("popstate",function(){var a=location.href==e;if(f.$canFirePopState||!a)f.$canFirePopState=!0,f.route()})},useLocationHash:function(){var f=this;h.one(window).on("hashchange",function(){f.suspend();f.route();f.resume()})}}});
KISSY.add("magix/impl/view",function(h,f,e,a){var e=function(){},c={idIt:1,wrapAsyncUpdate:1,registerAsyncUpdateName:1,extend:1};e.extend=function(b,d){var e=function(){e.superclass.constructor.apply(this,arguments);d&&a.safeExec(d,[],this)},g;for(g in this)a.hasProp(c,g)&&(e[g]=this[g]);return h.extend(e,this,b)};a.mix(e.prototype,{getTmplByXHR:function(b,c){f({url:b,dataType:"html",success:function(b){c(b)},error:function(b,a){c(a)}})},delegateUnbubble:function(b,c){var a=this;if(!a.$cacheEvents)a.$cacheEvents=
{};b=h.one(b);b.delegate(c,"*[mx"+c+"]",a.$cacheEvents[c]=function(b){a.processEvent(b)})},undelegateUnbubble:function(b,c){var a=this.$cacheEvents;a&&(b=h.one(b),b.undelegate(c,"*[mx"+c+"]",a[c]),delete a[c])}});return e},{requires:["ajax","sizzle","magix/magix"]});
KISSY.add("magix/magix",function(h,f){var e=function(b,c){return!b?!1:Object.prototype.hasOwnProperty.call(b,c)},a=function(b,c,a){for(var d in c)if(e(c,d)&&(!a||!e(a,d)))b[d]=c[d];return b},c=function(b,c,a,e,f,l){d.isArray(b)||(b=[b]);if(!c||!d.isArray(c)&&!c.callee)c=[c];for(e=0;e<b.length;e++)try{l=b[e],f=d.isFunction(l)&&l.apply(a,c)}catch(u){h.log(u,l)}return f},b=function(){throw Error("unimplement method");},d={isArray:b,isObject:b,isFunction:b,isRegExp:b,isString:b,isNumber:b,libRequire:b,
include:b,libEnv:b,mix:a,unimpl:b,hasProp:e,safeExec:c,noop:function(){},templates:{},cfg:{},locals:{},config:function(b){var c=this.cfg;if(b)this.cfg=a(c,b);return this.cfg},start:function(b){var a=this,b=a.config(b);a.libEnv();b.ready&&(c(b.ready),delete b.ready);a.libRequire("magix/router",function(b){a.libRequire("magix/vom",function(c){b.bind("locationChanged",function(b){b.changed.isViewPath()?c.remountRootVframe(b):c.notifyLocationChange(b)});b.bind("idle",function(){c.resume()});b.bind("busy",
function(){c.suspend()});b.start()})})},objectKeys:function(b){if(Object.keys)return Object.keys(b);var c=[],a;for(a in b)e(b,a)&&c.push(a);return c},local:function(b,c){var e=arguments,d=this.locals;if(0==e.length)return d;if(1==e.length)if(this.isObject(b))a(d,b);else return d[b];else d[b]=c}};return d.mix(d,f)},{requires:["magix/impl/magix"]});
KISSY.add("magix/router",function(h,f,e,a){var c=e.hasProp,b=e.mix,d=function(b){var j,a=this.params;e.isArray(b)||(b=(""+b).split(","));for(var n=0;n<b.length&&!(j=c(a,b[n]));n++);return j},i=function(){return c(this,k)},g=function(){return c(this,"viewPath")},p=function(){return this.hash[k]!=this.query[k]},m=function(b){return this.hash.params[b]!=this.query.params[b]},q=function(b){return c(this.hash.params,b)},l=function(b){return c(this.query.params,b)},u=function(b){return this.params[b]},
t=e.safeExec,o=window,v=encodeURIComponent,w=decodeURIComponent,x=/\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,y=/[^\/]*$/,s=/([#?]).*$/,r=/([^=&?\/#]+)=([^&=#?]*)/g,k="pathname",h=b({iQ:[],iC:0,qH:{},useHistoryState:e.unimpl,useLocationHash:e.unimpl,compareObject:function(b,j){for(var c=[],c=c.concat(e.objectKeys(b)),c=c.concat(e.objectKeys(j)),a=0;a<c.length;a++){var d=c[a];if(b[d]!=j[d])return!1}return!0},getPathnameRelations:function(){if(this.$pnr)return this.$pnr;var b={virtualToReal:{},virtualRegExpToReal:{}},
j=e.config().pathCfg,a=j.map,n=j.defaultView,d=j.defaultPathname||"";if(e.isObject(a))for(var g in a)if(c(a,g))for(var f=g,l=a[g],q=[],q=e.isArray(l)?l:e.isString(l)?l.split(","):[l],l=0;l<q.length;l++)e.isRegExp(q[l])?b.virtualRegExpToReal[f]=q[l]:(!d&&f==n&&(d=q[l]),b.virtualToReal[q[l]]=f);if(!n)throw Error("unset defaultView");b.virtualToReal[""]=n;b.home=n;b[k]=d;b.notFound=j.notFound;return this.$pnr=b},getViewPath:function(b){var j=this.getPathnameRelations();b||(b=j[k]);var c=j.virtualToReal[b];
if(!c)for(var a in j.virtualRegExpToReal)if(j.virtualRegExpToReal[a].test(b)){c=a;break}return{viewPath:c?c:j.notFound||j.home,pathname:c?b:j.notFound?b:j[k]}},start:function(){this.supportHistoryState()?this.useHistoryState():this.useLocationHash();this.route()},supportHistoryState:function(){var b=o.history;return e.config().useHistoryState&&b.pushState&&b.replaceState},pathToObject:function(b){var j={},c={},a=o.location.protocol,d="";s.test(b)?d=b.replace(s,""):~b.indexOf("=")||(d=b);if(d)if(0==
d.indexOf(a))a=d.indexOf("/",a.length+2),d=-1==a?"/":d.substring(a);else if("/"!=d.charAt(0)&&e.config().useHistoryState&&!this.supportHistoryState()){a=o.location[k].replace(y,"");for(a+=d;x.test(a);)a=a.replace(x,"$1/");d=a}b.replace(r,function(b,j,a){c[j]=a});j[k]=d;j.params=c;return j},objectToPath:function(b){var j=b[k],a=[],d;for(d in b.params)c(b.params,d)&&a.push(d+"="+b.params[d]);return j+(a.length?"?":"")+a.join("&")},parseQueryAndHash:function(){var a=o.location.href,j=this.qH;try{a=w(a)}catch(d){}if(c(j,
a))return j[a];var n=a.replace(/^[^?#]+/g,""),e=o.location[k]+n.replace(/^([^#]+).*$/g,"$1"),n=n.replace(/^[^#]*#?/g,""),g=this.pathToObject(e),f=this.pathToObject(n.replace(/^!?/,"")),i={};b(i,g.params);b(i,f.params);return j[a]={isPathnameDiff:p,isParamDiff:m,hashParamsOwn:q,queryParamsOwn:l,get:u,originalQuery:e,originalHash:n,query:g,hash:f,params:i}},parseLocation:function(){var a=this.parseQueryAndHash(),c=this.getViewPath(e.config().useHistoryState?a.hash[k]?a.hash[k]:a.query[k]:a.hash[k]);
return b(a,c)},getChangedLocation:function(b,a){var c={params:{}};b[k]!=a[k]&&(c[k]=!0);if(b.viewPath!=a.viewPath)c.viewPath=!0;for(var n=e.objectKeys(b.params),n=n.concat(e.objectKeys(a.params)),l=0;l<n.length;l++){var f=n[l];b.params[f]!==a.params[f]&&(c.params[f]=!0)}c.isParam=d;c.isPathname=i;c.isViewPath=g;return c},route:function(){var b=this.parseLocation(),a=this.$location||{params:{}},c=!this.$location,d;b.viewPath==(a.viewPath||"")?this.compareLocation(a,b)||(d=!0):d=!0;d&&(a=this.getChangedLocation(a,
b),this.trigger("locationChanged",{location:b,changed:a,firstFire:c}));this.$location=b;this.resume()},compareLocation:function(b,a){return b[k]!=a[k]?!1:this.compareObject(b.params,a.params)},navigate2:function(a){var j=this;a&&e.isString(a)&&j.idle(function(){j.trigger("busy");j.suspend();var d=j.pathToObject(a),n=b({},j.$location.params),n=b(n,d.params);if(d[k]){if(e.config().useHistoryState&&!j.supportHistoryState()&&(n=j.$location.query)&&(n=n.params))for(var g in n)c(n,g)&&!c(d.params,g)&&(d.params[g]=
"")}else d.params=n,d[k]=j.$location[k];j.compareLocation(d,j.$location)?j.resume():(d=j.objectToPath(d),j.supportHistoryState()?(j.$canFirePopState=!0,history.pushState(new Date,document.title,d),j.route()):location.hash="#!"+d)})},navigate:function(b,a){if(e.isObject(b)){var c=[],d;for(d in b)c.push(d+"="+v(b[d]));b=c.join("&");a&&(b=a+"?"+b)}this.navigate2(b)},idle:function(b){this.iC?this.iQ.push(b):t(b)},suspend:function(){this.iC++},resume:function(){0<this.iC&&(this.iC--,this.iC||(this.trigger("idle"),
this.iQ.length&&this.idle(this.iQ.shift())))}},a);return e.mix(h,f)},{requires:["magix/impl/router","magix/magix","magix/event"]});
KISSY.add("magix/vframe",function(h,f,e){var a=document,c=0,b=window.CollectGarbage||f.noop,d=f.safeExec,i=function(b){return"object"==typeof b?b:a.getElementById(b)},g=function(b){this.rC=0;this.rM={};this.notifyParentAlter();var a=this.view;d(a.trigger,"childrenAlter",a);this.unloadSubVframes(b)},p=/<script[^>]*>[\s\S]*?<\/script>/ig,m=function(b){this.id=m.idIt(b);this.viewId=this.id+"_view";this.children=[];this.view=null;this.rC=0;this.rM={}};f.mix(m,{tagName:"vframe",idIt:function(b){return b.id||
(b.id="magix_vf_"+c++)},createVframe:function(b,a){var b=i(b),c=new m(b);f.mix(c,a);return c},createVframeNode:function(b,c){var d=a.createElement(m.tagName);d.id=b;c.parentNode.insertBefore(d,c)}});a.createElement(m.tagName);f.mix(m.prototype,e);f.mix(m.prototype,{viewChangeUseAnim:function(){return!1},oldViewDestroy:f.noop,prepareNextView:f.noop,newViewCreated:f.noop,mountView:function(b){var a=this,c=i(a.id);c._dataBak?c._dataChged=1:(c._dataBak=1,c._dataTmpl=c.innerHTML.replace(p,""));var d=a.viewName&&
a.viewChangeUseAnim();a.unmountView(d,!0);if(b)a.viewName=b,f.libRequire(b,function(e){if(b==a.viewName){e.wrapAsyncUpdate();var f;d?(f=a.viewId,a.prepareNextView()):f=a.id;var i=new e({viewName:b,owner:a,ownerVOM:a.owner,id:f,vId:a.viewId,vfId:a.id});i.bind("interact",function(b){a.trigger("viewLoad",{view:i},a.vced=!0);d&&a.newViewCreated(!0);if(!b.tmpl){if(!d&&c._dataChged)c.innerHTML=c._dataTmpl;a.loadSubVframes()}i.bind("rendered",function(){a.loadSubVframes()});i.bind("prerender",function(b){g.call(a,
b.anim)})});a.view=i;i.load()}})},unmountView:function(a,c){if(this.view){g.call(this,a);this.view.destroy();this.vced=!1;var d=i(this.id);if(!a&&d._dataBak)d.innerHTML=d._dataTmpl,b();a&&c&&this.oldViewDestroy();delete this.view;delete this.viewName}else this.viewName&&(this.unbind("viewLoad"),delete this.viewName)},loadSubVframes:function(){this.owner.suspend();var b=(i(this.viewId)||i(this.id)).getElementsByTagName(m.tagName),a=b.length;if(a)for(var c=0,d;c<a;c++)d=b[c],d=m.createVframe(d,{owner:this.owner,
parentId:this.id}),this.children.push(d.id),d.mountView(b[c].getAttribute("data-view")),this.owner.registerVframe(d);else this.notifyChildrenCreated();this.owner.resume()},unloadSubVframes:function(b){for(var a=this.children,c,d=0,e=a.length,g;d<e;d++)g=a[d],c=this.owner.getVframe(g),c.unmountView(b),this.owner.unregisterVframe(c),i(g).id="";this.children=[]},notifyLocationChange:function(b){var a=this.view;if(a&&a.exist&&a.rendered){if(d(a.testOLChanged,b,a))var c=d(a.locationChange,b,a);if(!1!==
c){if(!f.isArray(c))c=this.children;for(var a=0,e=c.length,g;a<e;a++)(g=this.owner.getVframe(c[a]))&&d(g.notifyLocationChange,b,g)}}},notifyChildrenCreated:function(){var b=this.view;b&&d(b.trigger,"childrenCreated",b);this.notifyParentAlter(!0)},notifyParentAlter:function(b){var a=this.parentId;if(a)if(a=this.owner.getVframe(a),b)f.hasProp(a.rM,this.id)||(a.rM[this.id]=1,a.rC++,a.rC==a.children.length&&a.notifyChildrenCreated());else if(f.hasProp(a.rM,this.id))delete a.rM[this.id],a.rC--,b=a.view,
d(b.trigger,"childrenAlter",b),a.notifyParentAlter()},message:function(b){var a=this.view;a&&this.vced?d(a.receiveMessage,b,a):this.viewName&&this.bind("viewLoad",function(a){d(a.view.receiveMessage,b,a.view)})}});return m},{requires:["magix/magix","magix/event"]});
KISSY.add("magix/view",function(h,f,e,a){var c=1,b=e.safeExec,d=e.hasProp,i="render,renderUI,updateUI".split(","),g=function(b){e.mix(this,b);this.exist=!0;this.iQ=[];this.sign=this.iC=0},p=g.prototype,m=function(b,a){return function(){var c=this,d=arguments;c.idle(function(){a&&c.sign++;b.apply(c,d)},[],c,b)}},q=/(?:^|\s)return(?:(?:\s+[+\-\w$'"{\[\(\/])|[+\-{\[\(\/'"])/,l=/{([\s\S]+)}/,u=/\\[\s\S]/g,t=/\s*\/\s*/g,o=/^[\s\xa0\u3000\uFEFF]*$/,v=[/[^\w$_]\/[\s\S]*?\//,/(?:'[^']*')|(?:"[^"]*")/,/{[^{}]+}/],
w=function(b){if(b=(""+b).match(l)){b=b[1];if(o.test(b))return!0;for(var b=b.replace(u,"").replace(t,""),a=0,c;a<v.length;a++)for(c=v[a];c.test(b);)b=b.replace(c,"");return q.test(b)}return!1};e.mix(g,{idIt:function(b){return b.id||(b.id="magix_mxe_"+c++)},wrapAsyncUpdate:function(){if(!this["~~"]){this["~~"]=1;var b=this.prototype,a;this.registerAsyncUpdateName();for(var c in b){a=b[c];var g=null;e.isFunction(a)&&a!=e.noop&&!a["~~"]&&!w(a)&&(d(this.$ans,c)?g=m(a,!0):d(b,c)&&!d(p,c)&&(g=m(a)),g&&
(g["~~"]=a,b[c]=g))}}},registerAsyncUpdateName:function(b){if(!this.$ans){this.$ans={};for(var a=0;a<i.length;a++)this.$ans[i[a]]=!0}if(b){e.isArray(b)||(b=[b]);for(a=0;a<b.length;a++)this.$ans[b[a]]=!0}return this}});var x={submit:1,blur:1,focus:1,focusin:1,focusout:1,mouseenter:1,mouseleave:1,mousewheel:1,valuechange:1},h=g.prototype,y=document,s=window,r=s.CollectGarbage||e.noop,k="abort,stop,cancel,destroy,dispose".split(","),z=function(b){return"object"==typeof b?b:y.getElementById(b)};e.mix(h,
a);e.mix(h,{getTmplByXHR:e.unimpl,delegateUnbubble:e.unimpl,undelegateUnbubble:e.unimpl,render:e.noop,locationChange:e.noop,receiveMessage:e.noop,init:e.noop,hasTemplate:!0,enableEvent:!0,enableRefreshAnim:!1,load:function(){var a=this,c=a.hasTemplate,d=function(){a.suspend();b(a.render,[],a);a.delegateBubbleEvents();a.idle(function(){var d=!c&&!a.rendered;if(d)a.delegateUnbubbleEvents(),a.rendered=!0;b(a.init,[],a);d&&a.trigger("created",null,!0)});a.trigger("interact",{tmpl:c},!0);a.resume()};c?
a.getTemplate(a.manage(function(b){a.template=b;d()})):d()},updateViewId:function(){this.id=z(this.vId)?this.vId:this.vfId},setNodeHTML:function(b){z(this.id).innerHTML=b},setViewHTML:function(a){if(this.exist){var c=this.rendered;if(c){var d=e.config().viewChangeAnim&&this.enableRefreshAnim;this.trigger("refresh",null,!0,!0);this.trigger("prerender",{anim:d});this.destroyManaged(!0);this.undelegateUnBubbleEvents();var g=this.owner;d&&(b(g.oldViewDestroy,[],g),b(g.prepareNextView,[],g),this.updateViewId())}this.setNodeHTML(a);
r();d&&b(g.newViewCreated,[],g);this.delegateUnbubbleEvents();this.rendered=!0;this.trigger("rendered");c||this.trigger("created",null,!0)}},postMessageTo:function(b,a){var c=this.ownerVOM;this.idle(c.postMessage,[b,a],c)},idle:function(a,d,e,g){var f=this;g||(g=a);var i=g["~~_id_"],h=f.iQ;f.iC?(i?h[i]&&(h[i]["~~_id_"]="~~_id_"):i=g["~~_id_"]="~~"+c++,h.push([a,d,e,g]),h[i]=a):"~~_id_"!=a["~~_id_"]&&f.ownerVOM.idle(function(){f.exist&&(i&&delete h[i],b(a,d,e))})},getLocation:function(){return this.ownerVOM.$location},
observeLocation:function(b,a){var c=arguments.length;if(c)1==c&&(a=!1),this.$location={keys:e.isArray(b)?b:(""+b).split(","),pn:a}},testOLChanged:function(b){var a=this.$location,b=b.changed;if(a){var c=!1;a.pn&&(c=b.isPathname());c||(c=b.isParam(a.keys));return c}return!0},destroy:function(){this.trigger("refresh",null,!0,!0);this.trigger("destroy",null,!0,!0);this.destroyManaged();this.undelegateUnBubbleEvents();this.undelegateBubbleEvents();this.exist=!1;this.iQ=[];this.sign++},getTemplate:function(b){var a=
this;if(a.template)b(a.template);else{var c=e.templates[a.viewName];if(c)b(c);else{var c=e.config(),d=c.appHome+a.viewName+".html";c.release||(d+="?_="+(new Date).getTime()+".html");a.getTmplByXHR(d,function(c){b(e.templates[a.viewName]=c)})}}},processEvent:function(a){if(this.enableEvent&&this.exist){for(var c=a.target;c&&1!=c.nodeType;)c=c.parentNode;for(var d=c,e="mx"+a.type,f,i=z(this.vfId);d&&d!=i&&!(f=d.getAttribute(e));)d=d.parentNode;if(f)if(e=d.getAttribute("data-handler"))~[",",e,","].join().indexOf(","+
this.vfId+",")||(f=0);else{for(e=d;e&&e!=i;)if("VFRAME"==e.tagName.toUpperCase()){d.setAttribute("data-handler",e.id);f=0;break}else e=e.parentNode;f&&d.setAttribute("data-handler",this.vfId)}if(f){f=f.split(":");var i=f.shift(),e=f[f.length-1],h,d=g.idIt(d);if("_halt_"==e||"_stop_"==e)a.stopPropagation(),h=!0;if("_halt_"==e||"_prevent_"==e)a.preventDefault(),h=!0;h&&f.pop();h=this.events;for(var e=h[a.type],p=0,m;p<f.length;p++)m=f[p].lastIndexOf("@"),-1<m&&(f[f[p].substring(m+1)]=f[p].substring(0,
m));e[i]&&b(e[i],{view:this,currentId:d,targetId:g.idIt(c),domEvent:a,events:h,params:f},e)}}},fixedEvent:function(b){if(!b)b=s.event;if(b){if(!b.stopPropagation)b.stopPropagation=function(){b.cancelBubble=!0};if(!b.preventDefault)b.preventDefault=function(){b.returnValue=!1};if(b.srcElement&&!b.target)b.target=b.srcElement}return b},processDelegateEvents:function(b,a){var c=this;if(c.enableEvent){var e=c.events,g=z(c.vfId);if(c.$bubbleList&&c.$unbubbleList)for(var e=b?c.$bubbleList:c.$unbubbleList,
f=0;f<e.length;f++)b?g["on"+e[f]]=a?null:function(b){b=c.fixedEvent(b);c.processEvent(b)}:a?c.undelegateUnbubble(g,e[f]):c.delegateUnbubble(g,e[f]);else for(f in c.$bubbleList=[],c.$unbubbleList=[],e)d(e,f)&&(d(x,f)?(c.$unbubbleList.push(f),b||(a?c.undelegateUnbubble(g,f):c.delegateUnbubble(g,f))):(c.$bubbleList.push(f),b&&(g["on"+f]=a?null:function(b){b=c.fixedEvent(b);c.processEvent(b)})))}},delegateBubbleEvents:function(){this.processDelegateEvents(!0)},delegateUnbubbleEvents:function(){this.processDelegateEvents()},
undelegateUnBubbleEvents:function(){this.processDelegateEvents(!1,!0)},undelegateBubbleEvents:function(){this.processDelegateEvents(!0,!0)},manage:function(b,a){var d=!0;1==arguments.length&&(a=b,b="res_"+c++,d=!1);if(!this.$resCache)this.$resCache={};d={hasKey:d,res:a};e.isFunction(a)&&(a=this.wrapManagedFunction(a),d[this.sign]=a);this.$resCache[b]=d;return a},getManaged:function(b){var a=this.$resCache,c=this.sign;return a&&d(a,b)?(b=a[b],a=b.res,e.isFunction(a)&&(b[c]||(b[c]=this.wrapManagedFunction(a)),
a=b[c]),a):null},removeManaged:function(b){var a=null,c=this.$resCache;if(c)if(d(c,b))a=c[b].res,delete c[b];else for(var e in c)if(c[e].res===b){a=c[e].res;delete c[e];break}return a},destroyManaged:function(a){var c=this.$resCache;if(c){for(var d in c){var f=c[d],g=!1,i=f.res;if(e.isNumber(i))s.clearTimeout(i),s.clearInterval(i),g=!0;else if(i)for(var h=0;h<k.length;h++)e.isFunction(i[k[h]])&&(b(i[k[h]],[],i),g=!0);this.trigger("destroyResource",{resource:i,processed:g});a&&!f.hasKey&&delete c[d]}a||
(this.unbind("destroyResource"),delete this.$resCache)}},wrapManagedFunction:function(a){var c=this,d=c.sign;return function(){c.sign==d&&b(a,arguments,c)}},beginAsyncUpdate:function(){return this.sign++},signature:function(){return this.sign},endAsyncUpdate:function(){return this.sign},suspend:function(){this.iC++},resume:function(){0<this.iC&&this.iC--;if(!this.iC){var b=[].slice.call(this.iQ);for(this.iQ=[];b.length;)this.idle.apply(this,b.shift())}}});e.mix(g,f,{prototype:!0});e.mix(g.prototype,
f.prototype);return g},{requires:["magix/impl/view","magix/magix","magix/event"]});
KISSY.add("magix/vom",function(h,f,e,a){var c=document;return e.mix({iC:0,iQ:[],rootVframe:null,vframes:{},rootVframeId:"magix_vf_root",registerVframe:function(b){this.vframes[b.id]=b;this.trigger(b.id,{vframe:b},!0)},getVframe:function(b){return this.vframes[b]},unregisterVframe:function(b){delete this.vframes[e.isString(b)?b:b.id]},buildRootVframe:function(){if(!this.rootVframe)c.getElementById(this.rootVframeId)||f.createVframeNode(this.rootVframeId,c.body.firstChild),this.rootVframe=f.createVframe(this.rootVframeId,
{owner:this}),this.registerVframe(this.rootVframe)},remountRootVframe:function(b){this.$location=b.location;this.buildRootVframe();this.rootVframe.mountView(b.location.viewPath)},notifyLocationChange:function(b){this.$location=b.location;this.rootVframe&&this.rootVframe.notifyLocationChange(b)},idle:function(b,a,c){this.iC?this.iQ.push([b,a,c]):e.safeExec(b,a,c)},suspend:function(){this.iC++},resume:function(){0<this.iC&&this.iC--;if(!this.iC){var b=this.iQ;if(b.length){b=[].slice.call(b);for(this.iQ=
[];b.length;)this.idle.apply(this,b.shift())}}},postMessage:function(b,a){e.isArray(b)||(b=[b]);a||(a={});for(var c=0;c<b.length;c++){var g=this.getVframe(b[c]);g?g.message(a):this.bind(b[c],function(b){b.vframe.message(a)})}}},a)},{requires:["magix/vframe","magix/magix","magix/event"]});
KISSY.add("mxext/model",function(h,f){var e=function(a){a&&this.set(a);this.id=h.guid("m");this.hasLocker=this.locker=!1};f.mix(e,{GET:"GET",POST:"POST",extend:function(a,c){var b=function(){b.superclass.constructor.apply(this,arguments);c&&f.safeExec(c,[],this)};f.mix(b,this,{prototype:!0});return h.extend(b,this,a)}});f.mix(e.prototype,{urlMap:{},sync:f.noop,parse:f.noop,getParamsObject:function(a){if(!a)a=e.GET;return this["$"+a]||null},getPostParamsObject:function(){return this.getPostParamsObject(e.POST)},
getPostParams:function(){return this.getParams(e.POST)},getParams:function(a){var a=a?a.toUpperCase():e.GET,a=this["$"+a],c=[],b;if(a)for(var d in a)if(b=a[d],h.isArray(b))for(var f=0;f<b.length;f++)c.push(d+"="+encodeURIComponent(b[f]));else c.push(d+"="+encodeURIComponent(b));return c.join("&")},setParamsIf:function(a,c){this.setParams(a,c,e.GET,!0)},setParams:function(a,c,b,d){b=b?b.toUpperCase():e.GET;if(!this.$keysCache)this.$keysCache={};this.$keysCache[b]=!0;b="$"+b;this[b]||(this[b]={});if(h.isObject(a))for(var f in a){if(!d||
!this[b][f])this[b][f]=a[f]}else if(a&&c&&(!d||!this[b][a]))this[b][a]=c},setPostParams:function(a,c){this.setParams(a,c,e.POST)},setPostParamsIf:function(a,c){this.setParams(a,c,e.POST,!0)},removeParamsObject:function(a){if(!a)a=e.GET;delete this["$"+a]},removePostParamsObject:function(){this.removeParamsObject(e.POST)},reset:function(){var a=this.$keysCache;if(a){for(var c in a)f.hasProp(a,c)&&delete this["$"+c];delete this.$keysCache}a=this.$keys;c=this.$attrs;if(a){for(var b=0;b<a.length;b++)delete c[a[b]];
delete this.$keys}},url:function(){var a=this.get("uri"),c;if(a){c=a.split(":");var b=this.urlMap;if(b)for(var d=0;d<c.length&&!(b=b[c[d]],void 0===b);d++)d==c.length-1&&(a=b)}else throw Error("model not set uri");return a},get:function(a){var c=this.$attrs;return c?c[a]:null},set:function(a,c,b){if(!this.$attrs)this.$attrs={};if(b&&!this.$keys)this.$keys=[];if(h.isObject(a))for(var d in a)b&&this.$keys.push(d),this.$attrs[d]=a[d];else a&&(b&&this.$keys.push(a),this.$attrs[a]=c)},load:function(a){this.request(a)},
save:function(a){this.request(a)},request:function(a){a||(a={});var c=a.success,b=a.error,d=this;if(!d.hasLocker||!d.locker)d.$abort=!1,d.locker=d.hasLocker,a.success=function(b){d.locker=!1;if(!d.$abort){if(b){var a=d.parse(b);a&&(h.isArray(a)&&(a={list:a}),d.set(a,null,!0))}c&&c.apply(this,arguments)}},a.error=function(){d.locker=!1;d.$abort||b&&b.apply(this,arguments)},d.$trans=d.sync(d,a)},abort:function(){this.$trans&&this.$trans.abort&&this.$trans.abort();delete this.$trans;this.$abort=!0},
beginTransaction:function(){this.$bakAttrs=h.clone(this.$attrs)},rollbackTransaction:function(){var a=this.$bakAttrs;if(a)this.$attrs=a,delete this.$bakAttrs},endTransaction:function(){delete this.$bakAttrs},lock:function(a){this.hasLocker=!!a}});return e},{requires:["magix/magix"]});
KISSY.add("mxext/modelfactory",function(h,f){var e=function(a){this.$modelClass=a},a=function(a){if(a._wraped_)return a;var b=function(b){var e=b.success,g=this;g.get("updateIdent")?(b.success=function(){g.set("updateIdent",!1);g._after&&f.safeExec(g._after,g);e&&e.apply(b)},a.call(g,b)):e&&e.apply(b)};b._wraped_=!0;return b};f.mix(e,{mClsCache:{},create:function(a,b){if(!b)throw Error("Factory.create modelClass ungiven");var d=this.mClsCache;a||(a=h.guid());d[a]||(d[a]=new e(b));return d[a]}});f.mix(e.prototype,
{registerModels:function(a){f.isArray(a)||(a=[a]);for(var b=0,d;b<a.length;b++){d=a[b];if(!d.type)throw Error("model must own a type attribute");this[d.type]=d}},registerMethods:function(a){for(var b in a)f.hasProp(a,b)&&(this[b]=a[b])},callMethods:function(a,b,d){for(var e=[],f="",p=a.length,m=0,q,l=function(a,c,l){q||(m++,l?f=a:e[c]=a,p<=m&&(f?h.isFunction(d)&&d(f):h.isFunction(b)&&b.apply(b,e)))},u=function(a,b){return function(c){l(c,a,!b)}},t=0,o;t<a.length;t++){o=a[t];var v;if(v=h.isFunction(o.name)?
o.name:this[o.name]){if(!o.params)o.params=[];o.params.push(u(t,!0),u(t));v.apply(this,o.params)}else l("unfound:"+o.name,t,!0)}return{abort:function(){q=!0}}},fetchModels:function(a,b,d,e){var g=this;if(!g.$modelsCache)g.$modelsCache={};if(!g.$modelsCacheKeys)g.$modelsCacheKeys={};var p=g.$modelsCache,m=g.$modelsCacheKeys;f.isArray(a)||(a=[a]);for(var q=a.length,l=0,u,t=[],o=[],v,w=function(a,c,k,n){l++;if(c)u=n||"fetch data error";else{v=!0;k.set("updateIdent",!1);t[a]=k;if((a=k._cacheKey)&&!f.hasProp(p,
a))p[k._cacheKey]=k,a=k._params,k._doneAt=h.now(),k._after&&f.safeExec(k._after,[k].concat(a));4==e&&b(k)}if((a=k._cacheKey)&&f.hasProp(m,a)){var o=m[a];delete m[a];f.safeExec(o,[c,k,n],k)}4!=e&&l>=q&&(2==e?v?b&&b.apply(g,t):d&&d(u):u?d&&d(u):b&&b.apply(g,t))},x=Array.prototype.slice,y=function(a,b){var c=x.call(arguments,2);return function(){return a.apply(b,c.concat(x.call(arguments)))}},s=0,r;s<a.length;s++){r=a[s];var k=r.cacheKey;k&&f.hasProp(m,k)?m[k].push(y(w,g,s)):(r=g.create(r,!0),r.get("updateIdent")?
(o.push(r),k&&(m[k]=[]),r.request({success:y(w,r,s,!1,r),error:y(w,r,s,!0,r)})):w(s,!1,r))}return{abort:function(){for(var a=0,b;a<o.length;a++){b=o[a];var c=b._cacheKey;if(c&&f.hasProp(m,c)){var d=m[c];delete m[c];f.safeExec(d,[!0,b,"abort"],b)}b.abort()}}}},fetchAll:function(a,b,d){return this.fetchModels(a,b,d,1)},fetchAny:function(a,b,d){return this.fetchModels(a,b,d,2)},fetchOne:function(a,b){return this.fetchModels(a,b,f.noop,4)},getIf:function(a){var b=this.$modelsCache;return b&&f.hasProp(b,
a)?b[a]:null},setUpdateIdent:function(a){(a=this.getIf(a))&&a.set("updateIdent",!0)},create:function(c,b){if(!c.type)throw Error('model must own a "type" attribute');var d=c.type,e=c.cacheKey||d.cacheKey,g,p=c.expires||d.expires||0;if(!this.$modelsCache)this.$modelsCache={};var m=this.$modelsCache,q=c.params||[];if(e&&f.hasProp(m,e)){g=m[e];var l=g.get("updateIdent");!l&&0<p&&h.now()-g._doneAt>p&&(l=!0);l&&(delete m[e],g.set("updateIdent",!0))}else g=new this.$modelClass(d.ops),g._after=d.after,g._cacheKey=
e,g.set("updateIdent",!0);g._params=q;if(l=g.get("updateIdent"))g.reset(),g.set(c.ops),g.setParams(d.gets),g.setPostParams(d.posts),g.setParams(c.gets),g.setPostParams(c.posts),f.isFunction(d.before)&&f.safeExec(d.before,[g].concat(q),d);if(!b)g.request=a(g.request);return g}});return e},{requires:["magix/magix"]});
KISSY.add("mxext/vfanim",function(h,f,e){var a=e.config(),c=document,b=a.viewChange,d=e.isFunction(b),i=function(a){return"object"==typeof a?a:c.getElementById(a)};return e.mix(f.prototype,{viewChangeUseAnim:function(){return a.viewChangeAnim},oldViewDestroy:function(){var a=i(this.id),b=i(this.viewId),d=this.view;if(!b){for(b=c.createElement("div");a.firstChild;)b.appendChild(a.firstChild);a.appendChild(b)}b.id="";if(a=d.events)for(var f in a)e.hasProp(a,f)&&h.all("*[mx"+f+"]").removeAttr("mx"+f);
if(!e.hasProp(this,"$animCounter"))this.$animCounter=0;this.$animCounter++;this.$oldViewNode=b},prepareNextView:function(){var a=i(this.id),b=c.createElement("div");b.id=this.viewId;if(a._dataBak)b.innerHTML=a._dataTmpl;a.insertBefore(b,a.firstChild)},newViewCreated:function(a){var c=this,f=c.$oldViewNode,h=i(c.viewId);d&&e.safeExec(b,{vframeId:c.id,action:a?"viewChange":"viewRefresh",oldViewNode:f,newViewNode:h,collectGarbage:function(){c.$animCounter--;c.$animCounter||delete c.$oldViewNode;try{f.parentNode.removeChild(f)}catch(a){}}},
c)}})},{requires:["magix/vframe","magix/magix","sizzle"]});
KISSY.add("mxext/view",function(h,f,e){return f.extend({queryEvents:null,navigate:function(a){e.navigate(a)},attachQueryEvents:function(){var a=this,c=a.queryEvents;if(c){a.$queryEventsCache={};for(var b in c){var d=c[b],e;for(e in d)h.all("#"+a.id+" "+e).on(b,a.$queryEventsCache[b+"_"+e]=function(b){return function(d){var e=f.idIt(d.target),h=f.idIt(d.currentTarget);Magix.safeExec(b,{view:a,targetId:e,currentId:h,queryEvents:c,domEvent:d},c)}}(d[e]))}}},detachQueryEvents:function(){var a=this.queryEvents;
if(a){for(var c in a){var b=a[c],d;for(d in b)h.all("#"+this.id+" "+d).detach(c,this.$queryEventsCache[c+"_"+d])}delete this.$queryEventsCache}},setData:function(a){this.data=a;for(var c in a)a[c]&&a[c].toJSON&&(a[c]=a[c].toJSON());this.setRenderer()},setRenderer:function(){var a=this,c=this.renderer,b,d;if(c)for(b in c)for(d in c[b])(function(){var e=b,f=d,h=c[e][f];a.data[e+"_"+f]=function(){return h.call(this,a,e)}})()}},function(){var a=this;a.bind("created",function(){a.attachQueryEvents();a.bind("prerender",
function(){a.detachQueryEvents()});a.bind("rendered",function(){a.attachQueryEvents()})})})},{requires:["magix/view","magix/router"]});(function(h){var f=function(){};if(!h.console)h.console={log:f,warn:f,error:f,debug:f};if(!h.Magix)h.Magix={start:function(e){this.$tempCfg=e}},KISSY.use("magix/magix",function(e,a){var c=h.Magix.$tempCfg;h.Magix=a;c&&a.start(c)})})(this);