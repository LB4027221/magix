KISSY.add("magix/event",function(h,e){var d=e.safeExec;return{trigger:function(c,b,a,f){var i="~~"+c+"_list",g=this[i];if(g){b||(b={});if(!b.type)b.type=c;if(f)for(c=g.length-1;0<=c&&!(!1===d(g[c],b,this));c--);else{c=0;for(f=g.length;c<f&&!(!1===d(g[c],b,this));c++);}}a&&delete this[i]},bind:function(c,b){var a="~~"+c+"_list";this[a]||(this[a]=[]);this[a].push(b)},unbind:function(c,b){var a="~~"+c+"_list",f=this[a];if(f)if(b)for(var a=0,i=f.length;a<i;a++){if(f[a]==b){f.splice(a,1);break}}else delete this[a]}}},
{requires:["magix/magix"]});
KISSY.add("magix/impl/magix",function(h){return{include:function(e){var e=h.Config.packages.magix.path+e+".js?r="+Math.random()+".js",d=new (window.ActiveXObject||window.XMLHttpRequest)("Microsoft.XMLHTTP");d.open("GET",e,!1);d.send(null);return d.responseText},libRequire:function(e,d){h.use(e,function(c,b){d(b)})},libEnv:function(){var e=this.config(),d=e.appHome;if(!d)throw Error("please set appHome");d=d.replace(/(^|\/)app\/?/i,function(b,a){return a||"./"});e.appHome=d;if(!e.release&&/^https?:\/\//.test(d))e.release=
-1==d.indexOf(location.protocol+"//"+location.host);e.release||h.config({map:[[RegExp("("+d+".+)-min\\.js(\\?[^?]+)?"),"$1.js$2"]]});var c="";(c=e.release?e.appTag:h.now())&&(c+=".js");h.config({packages:[{name:"app",path:d,tag:c}]});e.viewChangeAnim&&h.Env.mods["mxext/vfanim"]&&h.use("mxext/vfanim")},isArray:h.isArray,isFunction:h.isFunction,isObject:h.isObject,isRegExp:h.isRegExp,isString:h.isString,isNumber:h.isNumber}});
KISSY.add("magix/impl/router",function(h){return{useHistoryState:function(){var e=this,d=location.href;h.one(window).on("popstate",function(){var c=location.href==d;if(e.$canFirePopState||!c)e.$canFirePopState=!0,e.route()})},useLocationHash:function(){var e=this;h.one(window).on("hashchange",function(){e.suspend();e.route();e.resume()})}}});
KISSY.add("magix/impl/view",function(h,e,d,c){var b=function(){},a={idIt:1,wrapAsyncUpdate:1,registerAsyncUpdateName:1,extend:1,prepare:1};b.extend=function(a,i){var g=function(){g.superclass.constructor.apply(this,arguments);i&&c.safeExec(i,[],this)};g.extend=b.extend;return h.extend(g,this,a)};b.prepare=function(b){if(!b.prepare)for(var i in this)c.hasProp(a,i)&&(b[i]=this[i])};c.mix(b.prototype,{getTmplByXHR:function(a,b){e({url:a,dataType:"html",success:function(a){b(a)},error:function(a,c){b(c)}})},
delegateUnbubble:function(a,b){var c=this;if(!c.$cacheEvents)c.$cacheEvents={};a=h.one(a);a.delegate(b,"*[mx"+b+"]",c.$cacheEvents[b]=function(a){c.processEvent(a)})},undelegateUnbubble:function(a,b){var c=this.$cacheEvents;c&&(a=h.one(a),a.undelegate(b,"*[mx"+b+"]",c[b]),delete c[b])}});return b},{requires:["ajax","sizzle","magix/magix"]});
KISSY.add("magix/magix",function(h,e){var d=function(a,b){return!a?!1:Object.prototype.hasOwnProperty.call(a,b)},c=function(a,b,c){for(var f in b)if(d(b,f)&&(!c||!d(c,f)))a[f]=b[f];return a},b=function(a,b,c,d,e,r){f.isArray(a)||(a=[a]);if(!b||!f.isArray(b)&&!b.callee)b=[b];for(d=0;d<a.length;d++)try{r=a[d],e=f.isFunction(r)&&r.apply(c,b)}catch(s){h.log(s,r)}return e},a=function(){throw Error("unimplement method");},f={isArray:a,isObject:a,isFunction:a,isRegExp:a,isString:a,isNumber:a,libRequire:a,
include:a,libEnv:a,mix:c,unimpl:a,hasProp:d,safeExec:b,noop:function(){},templates:{},cfg:{},locals:{},config:function(a){var b=this.cfg;if(a)this.cfg=c(b,a);return this.cfg},start:function(a){var c=this,a=c.config(a);c.libEnv();a.ready&&(b(a.ready),delete a.ready);c.libRequire("magix/router",function(a){c.libRequire("magix/vom",function(b){a.bind("locationChanged",function(a){a.changed.isViewPath()?b.remountRootVframe(a):b.notifyLocationChange(a)});a.bind("idle",function(){b.resume()});a.bind("busy",
function(){b.suspend()});a.start()})})},objectKeys:function(a){if(Object.keys)return Object.keys(a);var b=[],c;for(c in a)d(a,c)&&b.push(c);return b},local:function(a,b){var d=arguments,f=this.locals;if(0==d.length)return f;if(1==d.length)if(this.isObject(a))c(f,a);else return f[a];else f[a]=b}};return f.mix(f,e)},{requires:["magix/impl/magix"]});
KISSY.add("magix/router",function(h,e,d,c){var b=d.hasProp,a=d.mix,f=function(a){var c,k=this.params;d.isArray(a)||(a=(""+a).split(","));for(var j=0;j<a.length&&!(c=b(k,a[j]));j++);return c},i=function(){return b(this,l)},g=function(){return b(this,"viewPath")},q=function(){return this.hash[l]!=this.query[l]},o=function(a){return this.hash.params[a]!=this.query.params[a]},n=function(a){return b(this.hash.params,a)},r=function(a){return b(this.query.params,a)},s=function(a){return this.params[a]},
u=d.safeExec,p=window,w=encodeURIComponent,x=decodeURIComponent,y=/\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,z=/[^\/]*$/,v=/([#?]).*$/,t=/([^=&?\/#]+)=([^&=#?]*)/g,l="pathname",h=a({iQ:[],iC:0,qH:{},useHistoryState:d.unimpl,useLocationHash:d.unimpl,compareObject:function(a,b){for(var k=[],k=k.concat(d.objectKeys(a)),k=k.concat(d.objectKeys(b)),c=0;c<k.length;c++){var m=k[c];if(a[m]!=b[m])return!1}return!0},getPathnameRelations:function(){if(this.$pnr)return this.$pnr;var a={virtualToReal:{},virtualRegExpToReal:{}},
c=d.config().pathCfg,k=c.map,j=c.defaultView,m=c.defaultPathname||"";if(d.isObject(k))for(var f in k)if(b(k,f))for(var g=f,e=k[f],s=[],s=d.isArray(e)?e:d.isString(e)?e.split(","):[e],e=0;e<s.length;e++)d.isRegExp(s[e])?a.virtualRegExpToReal[g]=s[e]:(!m&&g==j&&(m=s[e]),a.virtualToReal[s[e]]=g);if(!j)throw Error("unset defaultView");a.virtualToReal[""]=j;a.home=j;a[l]=m;a.notFound=c.notFound;return this.$pnr=a},getViewPath:function(a){var b=this.getPathnameRelations();a||(a=b[l]);var k=b.virtualToReal[a];
if(!k)for(var c in b.virtualRegExpToReal)if(b.virtualRegExpToReal[c].test(a)){k=c;break}return{viewPath:k?k:b.notFound||b.home,pathname:k?a:b.notFound?a:b[l]}},start:function(){this.supportHistoryState()?this.useHistoryState():this.useLocationHash();this.route()},supportHistoryState:function(){var a=p.history;return d.config().useHistoryState&&a.pushState&&a.replaceState},pathToObject:function(a){var b={},c={},j=p.location.protocol,m="";v.test(a)?m=a.replace(v,""):~a.indexOf("=")||(m=a);if(m)if(0==
m.indexOf(j))j=m.indexOf("/",j.length+2),m=-1==j?"/":m.substring(j);else if("/"!=m.charAt(0)&&d.config().useHistoryState&&!this.supportHistoryState()){j=p.location[l].replace(z,"");for(j+=m;y.test(j);)j=j.replace(y,"$1/");m=j}a.replace(t,function(a,b,j){c[b]=j});b[l]=m;b.params=c;return b},objectToPath:function(a){var c=a[l],k=[],j;for(j in a.params)b(a.params,j)&&k.push(j+"="+a.params[j]);return c+(k.length?"?":"")+k.join("&")},parseQueryAndHash:function(){var c=p.location.href,f=this.qH;if(!d.config().originalHREF)try{c=
x(c)}catch(k){}if(b(f,c))return f[c];var j=c.replace(/^[^?#]+/g,""),m=p.location[l]+j.replace(/^([^#]+).*$/g,"$1"),j=j.replace(/^[^#]*#?/g,""),e=this.pathToObject(m),g=this.pathToObject(j.replace(/^!?/,"")),i={};a(i,e.params);a(i,g.params);return f[c]={isPathnameDiff:q,isParamDiff:o,hashParamsOwn:n,queryParamsOwn:r,get:s,originalQuery:m,originalHash:j,query:e,hash:g,params:i}},parseLocation:function(){var b=this.parseQueryAndHash(),c=this.getViewPath(d.config().useHistoryState?b.hash[l]?b.hash[l]:
b.query[l]:b.hash[l]);return a(b,c)},getChangedLocation:function(a,b){var c={params:{}};a[l]!=b[l]&&(c[l]=!0);if(a.viewPath!=b.viewPath)c.viewPath=!0;for(var j=d.objectKeys(a.params),j=j.concat(d.objectKeys(b.params)),m=0;m<j.length;m++){var e=j[m];a.params[e]!==b.params[e]&&(c.params[e]=!0)}c.isParam=f;c.isPathname=i;c.isViewPath=g;return c},route:function(){var a=this.parseLocation(),b=this.$location||{params:{}},c=!this.$location,j;a.viewPath==(b.viewPath||"")?this.compareLocation(b,a)||(j=!0):
j=!0;j&&(b=this.getChangedLocation(b,a),this.trigger("locationChanged",{location:a,changed:b,firstFire:c}));this.$location=a;this.resume()},compareLocation:function(a,b){return a[l]!=b[l]?!1:this.compareObject(a.params,b.params)},navigate2:function(c){var f=this;c&&d.isString(c)&&f.idle(function(){f.trigger("busy");f.suspend();var k=f.pathToObject(c),j=a({},f.$location.params),j=a(j,k.params);if(k[l]){if(d.config().useHistoryState&&!f.supportHistoryState()&&(j=f.$location.query)&&(j=j.params))for(var m in j)b(j,
m)&&!b(k.params,m)&&(k.params[m]="")}else k.params=j,k[l]=f.$location[l];f.compareLocation(k,f.$location)?f.resume():(k=f.objectToPath(k),f.supportHistoryState()?(f.$canFirePopState=!0,history.pushState(new Date,document.title,k),f.route()):location.hash="#!"+k)})},navigate:function(a,b){if(d.isObject(a)){var c=[],j=d.config().originalHREF,f;for(f in a)c.push(f+"="+(j?a[f]:w(a[f])));a=c.join("&");b&&(a=b+"?"+a)}this.navigate2(a)},idle:function(a){this.iC?this.iQ.push(a):u(a)},suspend:function(){this.iC++},
resume:function(){0<this.iC&&(this.iC--,this.iC||(this.trigger("idle"),this.iQ.length&&this.idle(this.iQ.shift())))}},c);return d.mix(h,e)},{requires:["magix/impl/router","magix/magix","magix/event"]});
KISSY.add("magix/vframe",function(h,e,d,c){var b=document,a=0,f=window.CollectGarbage||e.noop,i=e.safeExec,g=function(a){return"object"==typeof a?a:b.getElementById(a)},q=function(a){this.rC=0;this.rM={};this.notifyParentAlter();var b=this.view;i(b.trigger,"childrenAlter",b);this.unloadSubVframes(a)},o=/<script[^>]*>[\s\S]*?<\/script>/ig,n=function(a){this.id=n.idIt(a);this.viewId=this.id+"_view";this.children=[];this.view=null;this.rC=0;this.rM={}};e.mix(n,{tagName:"vframe",idIt:function(b){return b.id||
(b.id="magix_vf_"+a++)},createVframe:function(a,b){var a=g(a),c=new n(a);e.mix(c,b);return c},createVframeNode:function(a,c){var f=b.createElement(n.tagName);f.id=a;c.parentNode.insertBefore(f,c)}});b.createElement(n.tagName);e.mix(n.prototype,d);e.mix(n.prototype,{viewChangeUseAnim:function(){return!1},oldViewDestroy:e.noop,prepareNextView:e.noop,newViewCreated:e.noop,mountView:function(a){var b=this,f=g(b.id);f._dataBak?f._dataChged=1:(f._dataBak=1,f._dataTmpl=f.innerHTML.replace(o,""));var d=b.viewName&&
b.viewChangeUseAnim();b.unmountView(d,!0);if(a)b.viewName=a,e.libRequire(a,function(e){if(a==b.viewName){c.prepare(e);e.wrapAsyncUpdate();var g;d?(g=b.viewId,b.prepareNextView()):g=b.id;var i=new e({viewName:a,owner:b,ownerVOM:b.owner,id:g,vId:b.viewId,vfId:b.id});i.bind("interact",function(a){b.trigger("viewLoad",{view:i},b.vced=!0);d&&b.newViewCreated(!0);if(!a.tmpl){if(!d&&f._dataChged)f.innerHTML=f._dataTmpl;b.loadSubVframes()}i.bind("rendered",function(){b.loadSubVframes()});i.bind("prerender",
function(a){q.call(b,a.anim)})});b.view=i;i.load(n)}})},unmountView:function(a,b){if(this.view){q.call(this,a);this.view.destroy();this.vced=!1;var c=g(this.id);if(!a&&c._dataBak)c.innerHTML=c._dataTmpl,f();a&&b&&this.oldViewDestroy();delete this.view;delete this.viewName}else this.viewName&&(this.unbind("viewLoad"),delete this.viewName)},loadSubVframes:function(){var a=this.owner;a.suspend();var b=(g(this.viewId)||g(this.id)).getElementsByTagName(n.tagName),c=b.length;if(c)for(var f=0,d;f<c;f++)d=
b[f],d=n.createVframe(d,{owner:this.owner,parentId:this.id}),this.children.push(d.id),d.mountView(b[f].getAttribute("data-view")),a.registerVframe(d);else this.notifyChildrenCreated();a.resume()},unloadSubVframes:function(a){for(var b=this.children,c,f=0,d=b.length,e;f<d;f++)e=b[f],c=this.owner.getVframe(e),c.unmountView(a),this.owner.unregisterVframe(c),g(e).id="";this.children=[]},notifyLocationChange:function(a){var b=this.view;if(b&&b.exist&&b.rendered){if(i(b.testOLChanged,a,b))var c=i(b.locationChange,
a,b);if(!1!==c){if(!e.isArray(c))c=this.children;for(var b=0,f=c.length,d;b<f;b++)(d=this.owner.getVframe(c[b]))&&i(d.notifyLocationChange,a,d)}}},notifyChildrenCreated:function(){var a=this.view;a&&i(a.trigger,"childrenCreated",a);this.notifyParentAlter(!0)},notifyParentAlter:function(a){var b=this.parentId;if(b)if(b=this.owner.getVframe(b),a)e.hasProp(b.rM,this.id)||(b.rM[this.id]=1,b.rC++,b.rC==b.children.length&&b.notifyChildrenCreated());else if(e.hasProp(b.rM,this.id))delete b.rM[this.id],b.rC--,
a=b.view,i(a.trigger,"childrenAlter",a),b.notifyParentAlter()},message:function(a){var b=this.view;b&&this.vced?i(b.receiveMessage,a,b):this.bind("viewLoad",function(b){i(b.view.receiveMessage,a,b.view)})}});return n},{requires:["magix/magix","magix/event","magix/view"]});
KISSY.add("magix/view",function(h,e,d,c){var b=1,a=d.safeExec,f=d.hasProp,i,g="render,renderUI,updateUI".split(","),q=function(a){d.mix(this,a);this.exist=!0;this.iQ=[];this.sign=this.iC=0},o=q.prototype,n=function(a,b){return function(){var c=this,f=arguments;c.idle(function(){b&&c.sign++;a.apply(c,f)},[],c,a)}},r=/(?:^|\s)return(?:(?:\s+[+\-\w$'"{\[\(\/])|[+\-{\[\(\/'"])/,s=/{([\s\S]+)}/,u=/\\[\s\S]/g,p=/\s*\/\s*/g,w=/^[\s\xa0\u3000\uFEFF]*$/,x=[/[^\w$_]\/[\s\S]*?\//,/(?:'[^']*')|(?:"[^"]*")/,/{[^{}]+}/],
y=function(a){if(a=(""+a).match(s)){a=a[1];if(w.test(a))return!0;for(var a=a.replace(u,"").replace(p,""),b=0,c;b<x.length;b++)for(c=x[b];c.test(a);)a=a.replace(c,"");return r.test(a)}return!1};d.mix(q,{idIt:function(a){return a.id||(a.id="magix_mxe_"+b++)},wrapAsyncUpdate:function(){if(!this["~~"]){this["~~"]=1;var a=this.prototype,b;this.registerAsyncUpdateName();for(var c in a){b=a[c];var e=null;d.isFunction(b)&&b!=d.noop&&!b["~~"]&&!y(b)&&(f(this.$ans,c)?e=n(b,!0):f(a,c)&&!f(o,c)&&(e=n(b)),e&&
(e["~~"]=b,a[c]=e))}}},registerAsyncUpdateName:function(a){if(!this.$ans){this.$ans={};for(var b=0;b<g.length;b++)this.$ans[g[b]]=!0}if(a){d.isArray(a)||(a=[a]);for(b=0;b<a.length;b++)this.$ans[a[b]]=!0}return this}});var z={submit:1,blur:1,focus:1,focusin:1,focusout:1,mouseenter:1,mouseleave:1,mousewheel:1,valuechange:1},h=q.prototype,v=document,t=window,l=t.CollectGarbage||d.noop,B="abort,stop,cancel,destroy,dispose".split(","),A=function(a){return"object"==typeof a?a:v.getElementById(a)};d.mix(h,
c);d.mix(h,{getTmplByXHR:d.unimpl,delegateUnbubble:d.unimpl,undelegateUnbubble:d.unimpl,render:d.noop,locationChange:d.noop,receiveMessage:d.noop,init:d.noop,hasTemplate:!0,enableEvent:!0,enableRefreshAnim:!1,load:function(b){i||(i=b.tagName.toUpperCase());var c=this,f=c.hasTemplate,d=function(){c.suspend();a(c.init,[],c);a(c.render,[],c);c.delegateBubbleEvents();c.idle(function(){var a=!f&&!c.rendered;if(a)c.delegateUnbubbleEvents(),c.rendered=!0;a&&c.trigger("created",null,!0)});c.trigger("interact",
{tmpl:f},!0);c.resume()};f?c.getTemplate(c.manage(function(a){c.template=a;d()})):d()},updateViewId:function(){this.id=A(this.vId)?this.vId:this.vfId},setNodeHTML:function(a){A(this.id).innerHTML=a},setViewHTML:function(b){if(this.exist){var c=this.rendered;if(c){var f=d.config().viewChangeAnim&&this.enableRefreshAnim;this.trigger("refresh",null,!0,!0);this.trigger("prerender",{anim:f});this.destroyManaged(!0);this.undelegateUnBubbleEvents();var e=this.owner;f&&(a(e.oldViewDestroy,[],e),a(e.prepareNextView,
[],e),this.updateViewId())}this.setNodeHTML(b);l();f&&a(e.newViewCreated,[],e);this.delegateUnbubbleEvents();this.rendered=!0;this.trigger("rendered");c||this.trigger("created",null,!0)}},postMessageTo:function(a,b){var c=this.ownerVOM;this.idle(c.postMessage,[a,b],c)},idle:function(c,f,d,e){var g=this;e||(e=c);var i=e["~~_id_"],h=g.iQ;g.iC?(i?h[i]&&(h[i]["~~_id_"]="~~_id_"):i=e["~~_id_"]="~~"+b++,h.push([c,f,d,e]),h[i]=c):"~~_id_"!=c["~~_id_"]&&g.ownerVOM.idle(function(){g.exist&&(i&&delete h[i],
a(c,f,d))})},getLocation:function(){return this.ownerVOM.$location},observeLocation:function(a,b){var c=arguments.length;if(c)1==c&&(b=!1),this.$location={keys:d.isArray(a)?a:(""+a).split(","),pn:b}},testOLChanged:function(a){var b=this.$location,a=a.changed;if(b){var c=!1;b.pn&&(c=a.isPathname());c||(c=a.isParam(b.keys));return c}return!0},destroy:function(){this.trigger("refresh",null,!0,!0);this.trigger("destroy",null,!0,!0);this.destroyManaged();this.undelegateUnBubbleEvents();this.undelegateBubbleEvents();
this.exist=!1;this.iQ=[];this.sign++},getTemplate:function(a){var b=this;if(b.template)a(b.template);else{var c=d.templates[b.viewName];if(c)a(c);else{var c=d.config(),f=c.appHome+b.viewName+".html";c.release||(f+="?_="+(new Date).getTime()+".html");b.getTmplByXHR(f,function(c){a(d.templates[b.viewName]=c)})}}},processEvent:function(b){if(this.enableEvent&&this.exist){for(var c=b.target;c&&1!=c.nodeType;)c=c.parentNode;for(var f=c,d="mx"+b.type,e,g=A(this.vfId);f&&f!=g&&!(e=f.getAttribute(d));)f=
f.parentNode;if(e)if(d=f.getAttribute("data-handler"))~[",",d,","].join().indexOf(","+this.vfId+",")||(e=0);else{for(d=f;d&&d!=g;)if(d.tagName.toUpperCase()==i){f.setAttribute("data-handler",d.id);e=0;break}else d=d.parentNode;e&&f.setAttribute("data-handler",this.vfId)}if(e){e=e.split(":");var g=e.shift(),d=e[e.length-1],h,f=q.idIt(f);if("_halt_"==d||"_stop_"==d)b.stopPropagation(),h=!0;if("_halt_"==d||"_prevent_"==d)b.preventDefault(),h=!0;h&&e.pop();h=this.events;for(var d=h[b.type],n=0,o;n<e.length;n++)o=
e[n].lastIndexOf("@"),-1<o&&(e[e[n].substring(o+1)]=e[n].substring(0,o));d[g]&&a(d[g],{view:this,currentId:f,targetId:q.idIt(c),domEvent:b,events:h,params:e},d)}}},fixedEvent:function(a){if(!a)a=t.event;if(a){if(!a.stopPropagation)a.stopPropagation=function(){a.cancelBubble=!0};if(!a.preventDefault)a.preventDefault=function(){a.returnValue=!1};if(a.srcElement&&!a.target)a.target=a.srcElement}return a},processDelegateEvents:function(a,b){var c=this;if(c.enableEvent){var d=c.events,e=A(c.vfId);if(c.$bubbleList&&
c.$unbubbleList)for(var d=a?c.$bubbleList:c.$unbubbleList,g=0;g<d.length;g++)a?e["on"+d[g]]=b?null:function(a){a=c.fixedEvent(a);c.processEvent(a)}:b?c.undelegateUnbubble(e,d[g]):c.delegateUnbubble(e,d[g]);else for(g in c.$bubbleList=[],c.$unbubbleList=[],d)f(d,g)&&(f(z,g)?(c.$unbubbleList.push(g),a||(b?c.undelegateUnbubble(e,g):c.delegateUnbubble(e,g))):(c.$bubbleList.push(g),a&&(e["on"+g]=b?null:function(a){a=c.fixedEvent(a);c.processEvent(a)})))}},delegateBubbleEvents:function(){this.processDelegateEvents(!0)},
delegateUnbubbleEvents:function(){this.processDelegateEvents()},undelegateUnBubbleEvents:function(){this.processDelegateEvents(!1,!0)},undelegateBubbleEvents:function(){this.processDelegateEvents(!0,!0)},manage:function(a,c){var f=!0;1==arguments.length&&(c=a,a="res_"+b++,f=!1);if(!this.$resCache)this.$resCache={};f={hasKey:f,res:c};d.isFunction(c)&&(c=this.wrapManagedFunction(c),f[this.sign]=c);this.$resCache[a]=f;return c},getManaged:function(a){var b=this.$resCache,c=this.sign;return b&&f(b,a)?
(a=b[a],b=a.res,d.isFunction(b)&&(a[c]||(a[c]=this.wrapManagedFunction(b)),b=a[c]),b):null},removeManaged:function(a){var b=null,c=this.$resCache;if(c)if(f(c,a))b=c[a].res,delete c[a];else for(var d in c)if(c[d].res===a){b=c[d].res;delete c[d];break}return b},destroyManaged:function(b){var c=this.$resCache;if(c){for(var f in c){var e=c[f],g=!1,i=e.res;if(d.isNumber(i))t.clearTimeout(i),t.clearInterval(i),g=!0;else if(i)for(var h=0;h<B.length;h++)d.isFunction(i[B[h]])&&(a(i[B[h]],[],i),g=!0);this.trigger("destroyResource",
{resource:i,processed:g});b&&!e.hasKey&&delete c[f]}b||(this.unbind("destroyResource"),delete this.$resCache)}},wrapManagedFunction:function(b){var c=this,f=c.sign;return function(){c.sign==f&&a(b,arguments,c)}},beginAsyncUpdate:function(){return this.sign++},signature:function(){return this.sign},endAsyncUpdate:function(){return this.sign},suspend:function(){this.iC++},resume:function(){0<this.iC&&this.iC--;if(!this.iC){var a=[].slice.call(this.iQ);for(this.iQ=[];a.length;)this.idle.apply(this,a.shift())}}});
d.mix(q,e,{prototype:!0});d.mix(q.prototype,e.prototype);return q},{requires:["magix/impl/view","magix/magix","magix/event"]});
KISSY.add("magix/vom",function(h,e,d,c){var b=document;return d.mix({iC:0,iQ:[],rootVframe:null,vframes:{},rootVframeId:"magix_vf_root",registerVframe:function(a){this.vframes[a.id]=a;this.trigger(a.id,{vframe:a},!0)},getVframe:function(a){return this.vframes[a]},unregisterVframe:function(a){a=d.isString(a)?a:a.id;delete this.vframes[a];this.unbind(a)},buildRootVframe:function(){if(!this.rootVframe)b.getElementById(this.rootVframeId)||e.createVframeNode(this.rootVframeId,b.body.firstChild),this.rootVframe=
e.createVframe(this.rootVframeId,{owner:this}),this.registerVframe(this.rootVframe)},remountRootVframe:function(a){this.$location=a.location;this.buildRootVframe();this.rootVframe.mountView(a.location.viewPath)},notifyLocationChange:function(a){this.$location=a.location;this.rootVframe&&this.rootVframe.notifyLocationChange(a)},idle:function(a,b,c){this.iC?this.iQ.push([a,b,c]):d.safeExec(a,b,c)},suspend:function(){this.iC++},resume:function(){0<this.iC&&this.iC--;if(!this.iC){var a=this.iQ;if(a.length){a=
[].slice.call(a);for(this.iQ=[];a.length;)this.idle.apply(this,a.shift())}}},postMessage:function(a,b){d.isArray(a)||(a=[a]);b||(b={});for(var c=0;c<a.length;c++){var e=this.getVframe(a[c]);e?e.message(b):this.bind(a[c],function(a){a.vframe.message(b)})}}},c)},{requires:["magix/vframe","magix/magix","magix/event"]});
KISSY.add("mxext/model",function(h,e){var d=function(c){c&&this.set(c);this.id=h.guid("m");this.hasLocker=this.locker=!1};e.mix(d,{GET:"GET",POST:"POST",extend:function(c,b){var a=function(){a.superclass.constructor.apply(this,arguments);b&&e.safeExec(b,[],this)};e.mix(a,this,{prototype:!0});return h.extend(a,this,c)}});e.mix(d.prototype,{urlMap:{},sync:e.noop,parse:e.noop,getParamsObject:function(c){if(!c)c=d.GET;return this["$"+c]||null},getPostParamsObject:function(){return this.getPostParamsObject(d.POST)},
getPostParams:function(){return this.getParams(d.POST)},getParams:function(c){var c=c?c.toUpperCase():d.GET,c=this["$"+c],b=[],a;if(c)for(var f in c)if(a=c[f],h.isArray(a))for(var e=0;e<a.length;e++)b.push(f+"="+encodeURIComponent(a[e]));else b.push(f+"="+encodeURIComponent(a));return b.join("&")},setParamsIf:function(c,b){this.setParams(c,b,d.GET,!0)},setParams:function(c,b,a,f){a=a?a.toUpperCase():d.GET;if(!this.$keysCache)this.$keysCache={};this.$keysCache[a]=!0;a="$"+a;this[a]||(this[a]={});if(h.isObject(c))for(var e in c){if(!f||
!this[a][e])this[a][e]=c[e]}else if(c&&b&&(!f||!this[a][c]))this[a][c]=b},setPostParams:function(c,b){this.setParams(c,b,d.POST)},setPostParamsIf:function(c,b){this.setParams(c,b,d.POST,!0)},removeParamsObject:function(c){if(!c)c=d.GET;delete this["$"+c]},removePostParamsObject:function(){this.removeParamsObject(d.POST)},reset:function(){var c=this.$keysCache;if(c){for(var b in c)e.hasProp(c,b)&&delete this["$"+b];delete this.$keysCache}c=this.$keys;b=this.$attrs;if(c){for(var a=0;a<c.length;a++)delete b[c[a]];
delete this.$keys}},url:function(){var c=this.get("uri"),b;if(c){b=c.split(":");var a=this.urlMap;if(a)for(var f=0;f<b.length&&!(a=a[b[f]],void 0===a);f++)f==b.length-1&&(c=a)}else throw Error("model not set uri");return c},get:function(c){var b=this.$attrs;return b?b[c]:null},set:function(c,b,a){if(!this.$attrs)this.$attrs={};if(a&&!this.$keys)this.$keys=[];if(h.isObject(c))for(var f in c)a&&this.$keys.push(f),this.$attrs[f]=c[f];else c&&(a&&this.$keys.push(c),this.$attrs[c]=b)},load:function(c){this.request(c)},
save:function(c){this.request(c)},request:function(c){c||(c={});var b=c.success,a=c.error,f=this;if(!f.hasLocker||!f.locker)f.$abort=!1,f.locker=f.hasLocker,c.success=function(a){f.locker=!1;if(!f.$abort){if(a){var c=f.parse(a);c&&(h.isArray(c)&&(c={list:c}),f.set(c,null,!0))}b&&b.apply(this,arguments)}},c.error=function(){f.locker=!1;f.$abort||a&&a.apply(this,arguments)},f.$trans=f.sync(f,c)},abort:function(){this.$trans&&this.$trans.abort&&this.$trans.abort();delete this.$trans;this.$abort=!0},
beginTransaction:function(){this.$bakAttrs=h.clone(this.$attrs)},rollbackTransaction:function(){var c=this.$bakAttrs;if(c)this.$attrs=c,delete this.$bakAttrs},endTransaction:function(){delete this.$bakAttrs},lock:function(c){this.hasLocker=!!c}});return d},{requires:["magix/magix"]});
KISSY.add("mxext/modelfactory",function(h,e){var d=function(b){this.$modelClass=b},c=function(b){if(b._wraped_)return b;var a=function(a){var c=a.success,d=this;d.get("~~ui")?(a.success=function(){d.set("~~ui",!1);d._after&&e.safeExec(d._after,d);c&&c.apply(a)},b.call(d,a)):c&&c.apply(a)};a._wraped_=!0;return a};e.mix(d,{mClsCache:{},create:function(b,a){if(!a)throw Error("Factory.create modelClass ungiven");var c=this.mClsCache;b||(b=h.guid());c[b]||(c[b]=new d(a));return c[b]}});e.mix(d.prototype,
{registerModels:function(b){e.isArray(b)||(b=[b]);for(var a=0,c;a<b.length;a++){c=b[a];if(!c.type)throw Error("model must own a type attribute");this[c.type]=c}},registerMethods:function(b){for(var a in b)e.hasProp(b,a)&&(this[a]=b[a])},callMethods:function(b,a,c){for(var d=[],e="",q=b.length,o=0,n,r=function(b,p,r){n||(o++,r?e=b:d[p]=b,q<=o&&(e?h.isFunction(c)&&c(e):h.isFunction(a)&&a.apply(a,d)))},s=function(a,b){return function(c){r(c,a,!b)}},u=0,p;u<b.length;u++){p=b[u];var w;if(w=h.isFunction(p.name)?
p.name:this[p.name]){if(!p.params)p.params=[];p.params.push(s(u,!0),s(u));w.apply(this,p.params)}else r("unfound:"+p.name,u,!0)}return{abort:function(){n=!0}}},fetchModels:function(b,a,c,d){var g=this;if(!g.$modelsCache)g.$modelsCache={};if(!g.$modelsCacheKeys)g.$modelsCacheKeys={};var q=g.$modelsCache,o=g.$modelsCacheKeys;e.isArray(b)||(b=[b]);for(var n=b.length,r=0,s,u=[],p=[],w,x=function(b,l,k,j){r++;if(l)s=j||"fetch data error";else{w=!0;k.set("~~ui",!1);u[b]=k;if((b=k._cacheKey)&&!e.hasProp(q,
b))q[k._cacheKey]=k,b=k._params,k._doneAt=h.now(),k._after&&e.safeExec(k._after,[k].concat(b));4==d&&a(k)}if((b=k._cacheKey)&&e.hasProp(o,b)){var m=o[b];delete o[b];e.safeExec(m,[l,k,j],k)}4!=d&&r>=n&&(2==d?w?a&&a.apply(g,u):c&&c(s):s?c&&c(s):a&&a.apply(g,u))},y=Array.prototype.slice,z=function(a,b){var c=y.call(arguments,2);return function(){return a.apply(b,c.concat(y.call(arguments)))}},v=0,t;v<b.length;v++){t=b[v];var l=t.cacheKey;l&&e.hasProp(o,l)?o[l].push(z(x,g,v)):(t=g.create(t,!0),t.get("~~ui")?
(p.push(t),l&&(o[l]=[]),t.request({success:z(x,t,v,!1,t),error:z(x,t,v,!0,t)})):x(v,!1,t))}return{abort:function(){for(var a=0,b;a<p.length;a++){b=p[a];var c=b._cacheKey;if(c&&e.hasProp(o,c)){var d=o[c];delete o[c];e.safeExec(d,[!0,b,"abort"],b)}b.abort()}}}},fetchAll:function(b,a,c){return this.fetchModels(b,a,c,1)},fetchAny:function(b,a,c){return this.fetchModels(b,a,c,2)},fetchOne:function(b,a){return this.fetchModels(b,a,e.noop,4)},getIf:function(b){var a=this.$modelsCache;return a&&e.hasProp(a,
b)?a[b]:null},setUpdateIdent:function(b){(b=this.getIf(b))&&b.set("~~ui",!0)},create:function(b,a){if(!b.type)throw Error('model must own a "type" attribute');var d=b.type,i=b.cacheKey||d.cacheKey,g,q=b.expires||d.expires||0;if(!this.$modelsCache)this.$modelsCache={};var o=this.$modelsCache,n=b.params||[];if(i&&e.hasProp(o,i)){g=o[i];var r=g.get("~~ui");!r&&0<q&&h.now()-g._doneAt>q&&(r=!0);r&&(delete o[i],g.set("~~ui",!0))}else g=new this.$modelClass(d.ops),g._after=d.after,g._cacheKey=i,g.set("~~ui",
!0);g._params=n;if(r=g.get("~~ui"))g.reset(),g.set(b.ops),g.setParams(d.gets),g.setPostParams(d.posts),g.setParams(b.gets),g.setPostParams(b.posts),e.isFunction(d.before)&&e.safeExec(d.before,[g].concat(n),d);if(!a)g.request=c(g.request);return g}});return d},{requires:["magix/magix"]});
KISSY.add("mxext/vfanim",function(h,e,d){var c=d.config(),b=document,a=c.viewChange,f=d.isFunction(a),i=function(a){return"object"==typeof a?a:b.getElementById(a)};return d.mix(e.prototype,{viewChangeUseAnim:function(){return c.viewChangeAnim},oldViewDestroy:function(){var a=i(this.id),c=i(this.viewId),e=this.view;if(!c){for(c=b.createElement("div");a.firstChild;)c.appendChild(a.firstChild);a.appendChild(c)}c.id="";if(a=e.events)for(var f in a)d.hasProp(a,f)&&h.all("*[mx"+f+"]").removeAttr("mx"+f);
if(!d.hasProp(this,"$animCounter"))this.$animCounter=0;this.$animCounter++;this.$oldViewNode=c},prepareNextView:function(){var a=i(this.id),c=b.createElement("div");c.id=this.viewId;if(a._dataBak)c.innerHTML=a._dataTmpl;a.insertBefore(c,a.firstChild)},newViewCreated:function(c){var b=this,e=b.$oldViewNode,h=i(b.viewId);f&&d.safeExec(a,{vframeId:b.id,action:c?"viewChange":"viewRefresh",oldViewNode:e,newViewNode:h,collectGarbage:function(){b.$animCounter--;b.$animCounter||delete b.$oldViewNode;try{e.parentNode.removeChild(e)}catch(a){}}},
b)}})},{requires:["magix/vframe","magix/magix","sizzle"]});
KISSY.add("mxext/view",function(h,e,d){return e.extend({queryEvents:null,navigate:function(c){d.navigate(c)},attachQueryEvents:function(){var c=this,b=c.queryEvents;if(b){c.$queryEventsCache={};for(var a in b){var d=b[a],i;for(i in d)h.all("#"+c.id+" "+i).on(a,c.$queryEventsCache[a+"_"+i]=function(a){return function(d){var f=e.idIt(d.target),h=e.idIt(d.currentTarget);Magix.safeExec(a,{view:c,targetId:f,currentId:h,queryEvents:b,domEvent:d},b)}}(d[i]))}}},detachQueryEvents:function(){var c=this.queryEvents;
if(c){for(var b in c){var a=c[b],d;for(d in a)h.all("#"+this.id+" "+d).detach(b,this.$queryEventsCache[b+"_"+d])}delete this.$queryEventsCache}},setData:function(c){this.data=c;for(var b in c)c[b]&&c[b].toJSON&&(c[b]=c[b].toJSON());this.setRenderer()},setRenderer:function(){var c=this,b=this.renderer,a,d;if(b)for(a in b)for(d in b[a])(function(){var e=a,g=d,h=b[e][g];c.data[e+"_"+g]=function(){return h.call(this,c,e)}})()}},function(){var c=this;c.bind("created",function(){c.attachQueryEvents();c.bind("prerender",
function(){c.detachQueryEvents()});c.bind("rendered",function(){c.attachQueryEvents()})})})},{requires:["magix/view","magix/router"]});(function(h){var e=function(){};if(!h.console)h.console={log:e,warn:e,error:e,debug:e};if(!h.Magix)h.Magix={start:function(d){this.$tempCfg=d}},KISSY.use("magix/magix",function(d,c){var b=h.Magix.$tempCfg;h.Magix=c;b&&c.start(b)})})(this);