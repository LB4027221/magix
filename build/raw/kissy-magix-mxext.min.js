KISSY.add("magix/event",function(f,c){var d=c.safeExec;return{trigger:function(a,b,e,c){var h="~~"+a+"_list",g=this[h];if(g){b||(b={});if(!b.type)b.type=a;if(c)for(a=g.length-1;0<=a&&!(!1===d(g[a],b,this));a--);else{a=0;for(c=g.length;a<c&&!(!1===d(g[a],b,this));a++);}}e&&delete this[h]},bind:function(a,b){var e="~~"+a+"_list";this[e]||(this[e]=[]);this[e].push(b)},unbind:function(a,b){var e="~~"+a+"_list",c=this[e];if(c)if(b)for(var e=0,d=c.length;e<d;e++){if(c[e]==b){c.splice(e,1);break}}else delete this[e]}}},
{requires:["magix/magix"]});
KISSY.add("magix/impl/magix",function(f){return{include:function(c){var c=f.Config.packages.magix.path+c+".js?r="+Math.random(),d=new (window.ActiveXObject||window.XMLHttpRequest)("Microsoft.XMLHTTP");d.open("GET",c,!1);d.send(null);return d.responseText},libRequire:function(c,d){f.use(c,function(a,b){d(b)})},libEnv:function(){var c=this.config(),d=c.appHome;if(!d)throw Error("please set appHome");d=d.replace(/(^|\/)app\/?/i,function(a,b){return b||"./"});c.appHome=d;if(!c.release&&/^https?:\/\//.test(d))c.release=
-1==d.indexOf(location.protocol+"//"+location.host);c.release||f.config({map:[[RegExp("("+d+".+)-min\\.js(\\?[^?]+)?"),"$1.js$2"]]});f.config({packages:[{name:"app",path:d,tag:c.release?"":f.now()}]});c.viewChangeAnim&&f.use("mxext/vfanim")},isArray:f.isArray,isFunction:f.isFunction,isObject:f.isObject,isRegExp:f.isRegExp,isString:f.isString,isNumber:f.isNumber}});
KISSY.add("magix/impl/router",function(f){return{useHistoryState:function(){var c=this,d=location.href;f.one(window).on("popstate",function(){var a=location.href==d;if(c.$canFirePopState||!a)c.$canFirePopState=!0,c.route()})},useLocationHash:function(){var c=this;f.one(window).on("hashchange",function(){c.suspend();c.route();c.resume()})}}});
KISSY.add("magix/impl/view",function(f,c,d,a){var d=function(){},b={idIt:1,wrapAsyncUpdate:1,registerAsyncUpdateName:1,extend:1};d.extend=function(e,c){var d=function(){d.superclass.constructor.apply(this,arguments);c&&a.safeExec(c,[],this)},g;for(g in this)a.hasProp(b,g)&&(d[g]=this[g]);return f.extend(d,this,e)};a.mix(d.prototype,{getTmplByXHR:function(b,a){c({url:b,dataType:"html",success:function(b){a(b)},error:function(b,g){a(g)}})},delegateUnbubble:function(b,a){var c=this;if(!c.$cacheEvents)c.$cacheEvents=
{};b=f.one(b);b.delegate(a,"*[mx"+a+"]",c.$cacheEvents[a]=function(b){c.processEvent(b)})},undelegateUnbubble:function(b,a){var c=this.$cacheEvents;c&&(b=f.one(b),b.undelegate(a,"*[mx"+a+"]",c[a]),delete c[a])}});return d},{requires:["ajax","sizzle","magix/magix"]});
KISSY.add("magix/magix",function(f,c){var d=function(b,a){return!b?!1:Object.prototype.hasOwnProperty.call(b,a)},a=function(b,a,c){for(var e in a)if(d(a,e)&&(!c||!d(c,e)))b[e]=a[e];return b},b=function(b,a,c,e,d,f){i.isArray(b)||(b=[b]);if(!a||!i.isArray(a)&&!a.callee)a=[a];for(e=0;e<b.length;e++)try{f=b[e],d=i.isFunction(f)&&f.apply(c,a)}catch(s){}return d},e=function(){throw Error("unimplement method");},i={isArray:e,isObject:e,isFunction:e,isRegExp:e,isString:e,isNumber:e,libRequire:e,include:e,
libEnv:e,mix:a,unimpl:e,hasProp:d,safeExec:b,noop:function(){},templates:{},cfg:{},locals:{},config:function(b){var c=this.cfg;if(b)this.cfg=a(c,b);return this.cfg},start:function(a){var c=this,a=c.config(a);c.libEnv();a.ready&&(b(a.ready),delete a.ready);c.libRequire("magix/router",function(b){c.libRequire("magix/vom",function(a){b.bind("locationChanged",function(b){b.changed.isViewPath()?a.remountRootVframe(b):a.notifyLocationChange(b)});b.bind("idle",function(){a.resume()});b.bind("busy",function(){a.suspend()});
b.start()})})},objectKeys:function(b){if(Object.keys)return Object.keys(b);var a=[],c;for(c in b)d(b,c)&&a.push(c);return a},local:function(b,a){var c=arguments,e=this.locals;if(0==c.length)return e;if(1==c.length)if(this.isObject(b))for(var i in b)d(b,i)&&(e[i]=b[i]);else return e[b];else e[b]=a}};return i.mix(i,c)},{requires:["magix/impl/magix"]});
KISSY.add("magix/router",function(f,c,d,a){var b=d.hasProp,e=function(a){return b(this.params,a)},i=function(){return b(this,k)},h=function(){return b(this,"viewPath")},g=function(){return this.hash[k]!=this.query[k]},l=function(b){return this.hash.params[b]!=this.query.params[b]},j=function(a){return b(this.hash.params,a)},n=function(a){return b(this.query.params,a)},p=function(b){return this.params[b]},s=d.safeExec,r=window,v=encodeURIComponent,w=decodeURIComponent,t=/\/[^\/]+?\/\.{2}\/|([^:\/])\/\/+/,
x=/[^\/]*$/,u=/([#?]).*$/,m=/([^=&?\/#]+)=([^&=#?]*)/g,k="pathname",f=d.mix({iQ:[],iC:0,useHistoryState:d.unimpl,useLocationHash:d.unimpl,compareObject:function(b,a){if(d.isObject(b)&&d.isObject(a)){for(var c=[],c=c.concat(d.objectKeys(b)),c=c.concat(d.objectKeys(a)),e=0;e<c.length;e++){var g=c[e];if(b[g]!=a[g])return!1}return!0}return b==a},getPathnameRelations:function(){if(this.$pnr)return this.$pnr;var a={virtualToReal:{},virtualRegExpToReal:{}},c=d.config().pathCfg,e=c.map,g=c.defaultView,i=
c.defaultPathname;if(d.isObject(e)){for(var l in e)if(b(e,l)){var h=l;"/"==h.charAt(h.length-1)&&(h+="index");for(var j=e[l],f=[],f=d.isArray(j)?j:d.isString(j)?j.split(","):[j],j=0;j<f.length;j++)d.isRegExp(f[j])?a.virtualRegExpToReal[h]=f[j]:(!i&&h==g&&(i=f[j]),a.virtualToReal[f[j]]=h)}g&&"/"==g.charAt(g.length-1)&&(g+="index")}if(!g||!i)throw Error("unset defaultPathname or defaultView attribute for pathCfg");a.home=g;a[k]=i;a.hasNotFound=b(c,"notFound");a.notFound=c.notFound;return this.$pnr=
a},getViewPath:function(b){var a=this.getPathnameRelations();b||(b=a[k]);var c=a.virtualToReal[b];if(!c)for(var e in a.virtualRegExpToReal)if(a.virtualRegExpToReal[e].test(b)){c=e;break}return{viewPath:c?c:a.hasNotFound?a.notFound:a.home,pathname:c?b:a.hasNotFound?b:a[k]}},start:function(){this.supportHistoryState()?this.useHistoryState():this.useLocationHash();this.route()},supportHistoryState:function(){var b=r.history;return d.config().useHistoryState&&b.pushState&&b.replaceState},pathToObject:function(b){var a=
{},c={},e=r.location.protocol,g="";u.test(b)?g=b.replace(u,""):~b.indexOf("=")||(g=b);if(g)if(0==g.indexOf(e))e=g.indexOf("/",e.length+2),g=-1==e?"/":g.substring(e);else if("/"!=g.charAt(0)&&d.config().useHistoryState&&!this.supportHistoryState()){e=r.location[k].replace(x,"");for(e+=g;t.test(e);)e=e.replace(t,"$1/");g=e}b.replace(m,function(b,a,e){c[a]=e});a[k]=g;a.params=c;return a},objectToPath:function(a){var c=a[k],e=[],g;for(g in a.params)b(a.params,g)&&e.push(g+"="+a.params[g]);return c+(e.length?
"?":"")+e.join("&")},parseQueryAndHash:function(){var b=w(r.location.href),a=this.$QH;if(a&&a.p==b)return a.o;var c=b.replace(/^[^?#]+/g,""),a=r.location[k]+c.replace(/^([^#]+).*$/g,"$1"),c=c.replace(/^[^#]*#?/g,""),e=this.pathToObject(a),i=this.pathToObject(c.replace(/^!?/,"")),h={};d.mix(h,e.params);d.mix(h,i.params);a=this.$QH={p:b,o:{isPathnameDiff:g,isParamDiff:l,hashParamsOwn:j,queryParamsOwn:n,get:p,originalQuery:a,originalHash:c,query:e,hash:i,params:h}};return a.o},parseLocation:function(){var b=
this.parseQueryAndHash(),a=this.getViewPath(d.config().useHistoryState?b.hash[k]?b.hash[k]:b.query[k]:b.hash[k]);return d.mix(b,a)},getChangedLocation:function(b,a){var c={params:{}};b[k]!=a[k]&&(c[k]=!0);if(b.viewPath!=a.viewPath)c.viewPath=!0;for(var g=d.objectKeys(b.params),g=g.concat(d.objectKeys(a.params)),l=0;l<g.length;l++){var j=g[l];b.params[j]!=a.params[j]&&(c.params[j]=!0)}c.isParam=e;c.isPathname=i;c.isViewPath=h;return c},route:function(){var b=this.parseLocation(),a=this.$location||
{params:{}},c=!this.$location,e;b.viewPath==(a.viewPath||"")?this.compareLocation(a,b)||(e=!0):e=!0;e&&(a=this.getChangedLocation(a,b),this.trigger("locationChanged",{location:b,changed:a,firstFired:c}));this.$location=b;this.resume()},compareLocation:function(b,a){return b[k]!=a[k]?!1:this.compareObject(b.params,a.params)},navigate2:function(a){var c=this;a&&d.isString(a)&&c.idle(function(){c.suspend();c.trigger("busy");var e=c.pathToObject(a),g=d.mix({},c.$location.params),g=d.mix(g,e.params);if(e[k]){if(d.config().useHistoryState&&
!c.supportHistoryState()&&(g=c.$location.query)&&(g=g.params))for(var i in g)b(g,i)&&!b(e.params,i)&&(e.params[i]="")}else e.params=g,e[k]=c.$location[k];c.compareLocation(e,c.$location)?c.resume():(e=c.objectToPath(e),c.supportHistoryState()?(c.$canFirePopState=!0,history.pushState(new Date,document.title,e),c.route()):location.hash="#!"+e)})},navigate:function(b,a){if(d.isObject(b)){var c=[],e;for(e in b)c.push(e+"="+v(b[e]));b=c.join("&");a&&(b=a+"?"+b)}this.navigate2(b)},idle:function(b){this.iC?
this.iQ.push(b):s(b)},suspend:function(){this.iC++},resume:function(){0<this.iC&&this.iC--;if(!this.iC)if(this.iQ.length){var b=[].slice.call(this.iQ);for(this.iQ=[];b.length;)this.idle(b.shift())}else this.trigger("idle")}},a);return d.mix(f,c)},{requires:["magix/impl/router","magix/magix","magix/event"]});
KISSY.add("magix/vframe",function(f,c,d){var a=document,b=0,e=c.safeExec,i=function(b){return"object"==typeof b?b:a.getElementById(b)},h=function(b){this.id=h.idIt(b);this.viewId=this.id+"_view";this.children=[];this.view=null;this.ready={o:{},c:0}};c.mix(h,{tagName:"vframe",idIt:function(a){return a.id||(a.id="magix_vf_"+b++)},createVframe:function(b,a){var b=i(b),e=new h(b);c.mix(e,a);return e},createVframeNode:function(b,c){var e=a.createElement(h.tagName);e.id=b;c.parentNode.insertBefore(e,c)}});
a.createElement(h.tagName);c.mix(h.prototype,d);c.mix(h.prototype,{viewChangeUseAnim:function(){return!1},oldViewDestroy:c.noop,prepareNextView:c.noop,newViewCreated:c.noop,mountView:function(b){var a=this,e=a.viewName&&a.viewChangeUseAnim();a.unmountView(e,!0);if(b)a.viewName=b,c.libRequire(b,function(c){if(b==a.viewName){c.wrapAsyncUpdate();var d;e?(d=a.viewId,a.prepareNextView()):d=a.id;var i=new c({viewName:b,owner:a,ownerVOM:a.owner,id:d,vId:a.viewId,vfId:a.id});i.bind("ready",function(b){i.bind("created",
function(){a.trigger("viewLoad",{view:i},!0);a.viewCreated=!0});e&&a.newViewCreated(!0);b.tmpl||a.loadSubVframes();i.bind("rendered",function(){a.loadSubVframes()});i.bind("prerender",function(b){a.unloadSubVframes(b.anim)})});a.view=i;i.load()}})},unmountView:function(b,a){this.view?(this.unloadSubVframes(b),this.view.destroy(b),b&&a&&this.oldViewDestroy(),delete this.view,delete this.viewName):this.viewName&&(this.unbind("viewLoad"),this.unbind("childrenCreated"),delete this.viewName)},loadSubVframes:function(){var b=
this;b.owner.suspend();var a=(i(b.viewId)||i(b.id)).getElementsByTagName(h.tagName),e=a.length;if(e)for(var d=0,f;d<e;d++)f=a[d],f=h.createVframe(f,{owner:b.owner,parentId:b.id}),b.children.push(f.id),b.owner.registerVframe(f),f.bind("childrenCreated",function(){var a=b.ready,e=this.id;c.hasProp(a.o,e)||(a.o[e]=1,a.c++);if(a.c==b.children.length)b.ready={o:{},c:0},b.notifyChildrenCreated()}),f.mountView(a[d].getAttribute("data-view"));else b.notifyChildrenCreated();b.owner.resume()},unloadSubVframes:function(b){for(var a=
this.children,c,e=0,d=a.length,h;e<d;e++)h=a[e],c=this.owner.getVframe(h),c.unmountView(b),this.owner.unregisterVframe(c),i(h).id="";this.children=[]},postMessageTo:function(b,a){var d=this.owner;c.isArray(b)||(b=[b]);a||(a={});for(var i=0;i<b.length;i++){var h=d.getVframe(b[i]);if(h){var f=h.view;f&&f.rendered?e(f.receiveMessage,a,f):h.viewName&&h.bind("viewLoad",function(b){e(b.view.receiveMessage,a,b.view)})}}},notifyLocationChange:function(b){var a=this.view;if(a&&a.exist&&a.rendered){if(e(a.testObserveLocationChanged,
b,a))var d=e(a.locationChange,b,a);if(!1!==d){if(!c.isArray(d))d=this.children;for(var a=0,i=d.length,h;a<i;a++)(h=this.owner.getVframe(d[a]))&&e(h.notifyLocationChange,b,h)}}},notifyChildrenCreated:function(){var b=this,a=function(){var a=b.view;a&&e(a.trigger,"childrenCreated",a);b.trigger("childrenCreated",0,!0)};b.viewCreated?a():b.bind("viewLoad",a)}});return h},{requires:["magix/magix","magix/event"]});
KISSY.add("magix/view",function(f,c,d,a){var b=1,e=d.safeExec,i=d.hasProp,h=["render","renderUI","updateUI"],g=function(b){d.mix(this,b);this.exist=!0;this.iQ=[];this.sign=this.iC=0},l=g.prototype,j=function(b,a){return function(){var c=this,e=arguments;c.idle(function(){a&&c.sign++;b.apply(c,e)})}},n=/(?:^|\s)return(?:(?:\s+[+\-\w$'"{\[\(\/])|[+\-{\[\(\/'"])/,p=/{([\s\S]+)}/,s=/\\[\s\S]/g,r=/\s*\/\s*/g,v=/^[\s\xa0\u3000\uFEFF]*$/,w=[/[^\w$_]\/[\s\S]*?\//,/(?:'[^']*')|(?:"[^"]*")/,/{[^{}]+}/],t=function(b){if(b=
(""+b).match(p)){b=b[1];if(v.test(b))return!0;for(var b=b.replace(s,"").replace(r,""),a=0,c;a<w.length;a++)for(c=w[a];c.test(b);)b=b.replace(c,"");return n.test(b)}return!1};d.mix(g,{idIt:function(a){return a.id||(a.id="magix_mxe_"+b++)},wrapAsyncUpdate:function(){if(!this["~~"]){this["~~"]=1;var b=this.prototype,a;this.registerAsyncUpdateName();for(var c in b){a=b[c];var e=null;d.isFunction(a)&&a!=d.noop&&!a["~~"]&&!t(a)&&(i(this.$ans,c)?e=j(a,!0):i(b,c)&&!i(l,c)&&(e=j(a)),e&&(e["~~"]=a,b[c]=e))}}},
registerAsyncUpdateName:function(b){if(!this.$ans){this.$ans={};for(var a=0;a<h.length;a++)this.$ans[h[a]]=!0}if(b){d.isArray(b)||(b=[b]);for(a=0;a<b.length;a++)this.$ans[b[a]]=!0}return this}});var x={blur:1,focus:1,focusin:1,focusout:1,mouseenter:1,mouseleave:1,mousewheel:1,valuechange:1},f=g.prototype,u=document,m=window,k=["abort","stop","cancel","destroy","dispose"],o=function(b){return"object"==typeof b?b:u.getElementById(b)};d.mix(f,a);d.mix(f,{getTmplByXHR:d.unimpl,delegateUnbubble:d.unimpl,
undelegateUnbubble:d.unimpl,render:d.noop,locationChange:d.noop,receiveMessage:d.noop,init:d.noop,hasTemplate:!0,enableEvent:!0,enableRefreshAnim:!1,load:function(){var b=this,a=function(){b.suspend();e(b.render,[],b);b.delegateBubbleEvents();b.idle(function(){if(!b.rendered)b.delegateUnbubbleEvents(),b.rendered=!0;e(b.init,[],b);b.trigger("created",null,!0);var a=d.config().viewLoad;d.isFunction(a)&&e(a,{name:b.viewName,location:b.getLocation()})});b.trigger("ready",{tmpl:b.hasTemplate},!0);b.resume()};
b.hasTemplate?b.getTemplate(b.manage(function(c){b.template=c;a()})):a()},updateViewId:function(){this.id=o(this.vId)?this.vId:this.vfId},setNodeHTML:function(b){o(this.id).innerHTML=b},setViewHTML:function(b){if(this.exist){this.trigger("refresh",null,!0,!0);var a=d.config().viewChangeAnim&&this.rendered&&this.enableRefreshAnim;this.trigger("prerender",{anim:a});this.destroyManaged(!0);this.undelegateUnBubbleEvents();this.destroyFrames();var c=this.owner;a&&(e(c.oldViewDestroy,[],c),e(c.prepareNextView,
[],c),this.updateViewId());if(!this.rendered)this.$bakHTML=o(this.id).innerHTML;this.setNodeHTML(b);a&&e(c.newViewCreated,[],c);this.delegateUnbubbleEvents();this.rendered=!0;this.trigger("rendered")}},postMessageTo:function(b,a){this.idle(this.owner.postMessageTo,[b,a],this.owner)},idle:function(b,a,c){var i=this;i.iC?i.iQ.push([b,a,c]):i.ownerVOM.idle(function(){i.exist&&d.isFunction(b)&&e(b,a,c)})},getLocation:function(){return this.ownerVOM.$location},observeLocation:function(b,a){var c=arguments;
1==c.length&&(a=!1);if(c.length)this.$location={keys:d.isArray(b)?b:(""+b).split(","),pn:a}},testObserveLocationChanged:function(b){var a=this.$location,b=b.changed;if(a){var c=!1;a.pn&&(c=b.isPathname());if(!c)for(var a=a.keys,e=0;e<a.length;e++)if(b.isParam(a[e])){c=!0;break}return c}return!0},destroyFrames:function(){for(var b=o(this.id).getElementsByTagName("iframe"),a,c;b.length;)a=b[0],c=a.parentNode,a.src="",c.removeChild(a);m.CollectGarbage&&m.CollectGarbage()},destroy:function(b){this.trigger("refresh",
null,!0,!0);this.trigger("destroy",null,!0,!0);this.destroyManaged();this.undelegateUnBubbleEvents();this.undelegateBubbleEvents();if(this.hasTemplate&&!b)this.destroyFrames(),o(this.vfId).innerHTML=this.$bakHTML||"";this.exist=!1;this.iQ=[];this.sign++},getTemplate:function(b){var a=this;if(a.template)b(a.template);else{var c=d.templates[a.viewName];if(c)b(c);else{var c=d.config(),e=c.appHome+a.viewName+".html";c.release||(e+="?_="+(new Date).getTime());a.getTmplByXHR(e,function(c){b(d.templates[a.viewName]=
c)})}}},processEvent:function(b){if(this.enableEvent&&this.exist){for(var a=b.target,c=a;1!=c.nodeType;)c=c.parentNode;for(var d="mx"+b.type,i=c.getAttribute(d),h=o(this.vfId);!i&&c!=h;)c=c.parentNode,i=c.getAttribute(d);if(i){var d=i.split(":"),i=d.shift(),h=d[d.length-1],f,c=g.idIt(c);if("_halt_"==h||"_stop_"==h)b.stopPropagation(),f=!0;if("_halt_"==h||"_prevent_"==h)b.preventDefault(),f=!0;f&&d.pop();f=this.events;for(var h=f[b.type],l=0,j;l<d.length;l++)j=d[l].lastIndexOf("@"),-1<j&&(d[d[l].substring(j+
1)]=d[l].substring(0,j));h[i]&&e(h[i],{view:this,currentId:c,targetId:g.idIt(a),domEvent:b,events:f,params:d},h)}}},fixedEvent:function(b){if(!b)b=m.event;if(b){if(!b.stopPropagation)b.stopPropagation=function(){b.cancelBubble=!0};if(!b.preventDefault)b.preventDefault=function(){b.returnValue=!1};if(b.srcElement&&!b.target)b.target=b.srcElement}return b},processDelegateEvents:function(b,a){var c=this;if(c.enableEvent){var e=c.events,d=o(c.vfId);if(c.$bubbleList&&c.$unbubbleList)for(var e=b?c.$bubbleList:
c.$unbubbleList,g=0;g<e.length;g++)b?d["on"+e[g]]=a?null:function(b){b=c.fixedEvent(b);c.processEvent(b)}:a?c.undelegateUnbubble(d,e[g]):c.delegateUnbubble(d,e[g]);else for(g in c.$bubbleList=[],c.$unbubbleList=[],e)i(e,g)&&(i(x,g)?(c.$unbubbleList.push(g),b||(a?c.undelegateUnbubble(d,g):c.delegateUnbubble(d,g))):(c.$bubbleList.push(g),b&&(d["on"+g]=a?null:function(b){b=c.fixedEvent(b);c.processEvent(b)})))}},delegateBubbleEvents:function(){this.processDelegateEvents(!0)},delegateUnbubbleEvents:function(){this.processDelegateEvents()},
undelegateUnBubbleEvents:function(){this.processDelegateEvents(!1,!0)},undelegateBubbleEvents:function(){this.processDelegateEvents(!0,!0)},manage:function(a,c){var e=!0;1==arguments.length&&(c=a,a="res_"+b++,e=!1);if(!this.$resCache)this.$resCache={};e={hasKey:e,res:c};d.isFunction(c)&&(c=this.wrapManagedFunction(c),e[this.sign]=c);this.$resCache[a]=e;return c},getManaged:function(b){var a=this.$resCache,c=this.sign;return a&&i(a,b)?(b=a[b],a=b.res,d.isFunction(a)&&(b[c]||(b[c]=this.wrapManagedFunction(a)),
a=b[c]),a):null},removeManaged:function(b){var a=this.$resCache;if(a)if(i(a,b))delete a[b];else for(var c in a)if(a[c].res===b){delete a[c];break}},destroyManaged:function(b){var a=this.$resCache;if(a){for(var c in a){var i=a[c],g=!1,h=i.res;if(d.isNumber(h))m.clearTimeout(h),m.clearInterval(h),g=!0;else if(h)for(var f=0;f<k.length;f++)d.isFunction(h[k[f]])&&(e(h[k[f]],[],h),g=!0);this.trigger("destroyResource",{resource:h,processed:g});b&&!i.hasKey&&delete a[c]}b||(this.unbind("destroyResource"),
delete this.$resCache)}},wrapManagedFunction:function(b){var a=this,c=a.sign;return function(){a.sign==c&&e(b,arguments,a)}},beginAsyncUpdate:function(){return this.sign++},signature:function(){return this.sign},endAsyncUpdate:function(){return this.sign},suspend:function(){this.iC++},resume:function(){0<this.iC&&this.iC--;if(!this.iC){var b=[].slice.call(this.iQ);for(this.iQ=[];b.length;)this.idle.apply(this,b.shift())}}});d.mix(g,c,{prototype:!0});d.mix(g.prototype,c.prototype);return g},{requires:["magix/impl/view",
"magix/magix","magix/event"]});
KISSY.add("magix/vom",function(f,c,d){var a=document;return{iC:0,iQ:[],rootVframe:null,vframes:{},rootVframeId:"magix_vf_root",registerVframe:function(b){this.vframes[b.id]=b},getVframe:function(b){return this.vframes[b]},unregisterVframe:function(b){delete this.vframes[d.isString(b)?b:b.id]},buildRootVframe:function(){if(!this.rootVframe)a.getElementById(this.rootVframeId)||c.createVframeNode(this.rootVframeId,a.body.firstChild),this.rootVframe=c.createVframe(this.rootVframeId,{owner:this}),this.registerVframe(this.rootVframe)},
remountRootVframe:function(b){this.$location=b.location;this.buildRootVframe();this.rootVframe.mountView(b.location.viewPath)},notifyLocationChange:function(b){this.$location=b.location;this.rootVframe&&this.rootVframe.notifyLocationChange(b)},idle:function(b,a,c){this.iC?this.iQ.push([b,a,c]):d.safeExec(b,a,c)},suspend:function(){this.iC++},resume:function(){0<this.iC&&this.iC--;if(!this.iC){var b=this.iQ;if(b.length){b=[].slice.call(b);for(this.iQ=[];b.length;)this.idle.apply(this,b.shift())}}}}},
{requires:["magix/vframe","magix/magix"]});
KISSY.add("mxext/model",function(f,c){var d=function(a){a&&this.set(a);this.id=f.guid("m");this.hasLocker=this.locker=!1};c.mix(d,{GET:"GET",POST:"POST",extend:function(a,b){var e=function(){e.superclass.constructor.apply(this,arguments);b&&c.safeExec(b,[],this)};c.mix(e,this,{prototype:!0});return f.extend(e,this,a)}});c.mix(d.prototype,{urlMap:{},sync:c.noop,parse:c.noop,getPostParams:function(){return this.getParams("POST")},getParams:function(a){var a=a?a.toUpperCase():d.GET,a=this["$"+a],b=[],
c;if(a)for(var i in a)if(c=a[i],f.isArray(c))for(var h=0;h<c.length;h++)b.push(i+"="+encodeURIComponent(c[h]));else b.push(i+"="+encodeURIComponent(c));return b.join("&")},setParamsIf:function(a,b){this.setParams(a,b,d.GET,!0)},setParams:function(a,b,c,i){c=c?c.toUpperCase():d.GET;if(!this.$keysCache)this.$keysCache={};this.$keysCache[c]=!0;c="$"+c;this[c]||(this[c]={});if(f.isObject(a))for(var h in a){if(!i||!this[c][h])this[c][h]=a[h]}else if(a&&b&&(!i||!this[c][a]))this[c][a]=b},setPostParams:function(a,
b){this.setParams(a,b,d.POST)},setPostParamsIf:function(a,b){this.setParams(a,b,d.POST,!0)},reset:function(){var a=this.$keysCache;if(a){for(var b in a)c.hasProp(a,b)&&delete this["$"+b];delete this.$keysCache}a=this.$keys;b=this.$attrs;if(a){for(var e=0;e<a.length;e++)delete b[a[e]];delete this.$keys}},url:function(){var a=this.get("uri"),b;if(a){b=a.split(":");var c=this.urlMap;if(c)for(var d=0;d<b.length&&!(c=c[b[d]],void 0===c);d++)d==b.length-1&&(a=c)}else throw Error("model not set uri");return a},
get:function(a){var b=this.$attrs;return b?b[a]:null},set:function(a,b,c){if(!this.$attrs)this.$attrs={};if(c&&!this.$keys)this.$keys=[];if(f.isObject(a))for(var d in a)c&&this.$keys.push(d),this.$attrs[d]=a[d];else a&&(c&&this.$keys.push(a),this.$attrs[a]=b)},load:function(a){this.request(a)},save:function(a){this.request(a)},request:function(a){a||(a={});var b=a.success,c=a.error,d=this;if(!d.hasLocker||!d.locker)d.$abort=!1,d.locker=d.hasLocker,a.success=function(a){d.locker=!1;if(!d.$abort){if(a){var c=
d.parse(a);c&&(f.isArray(c)&&(c={list:c}),d.set(c,null,!0))}b&&b.apply(this,arguments)}},a.error=function(){d.locker=!1;d.$abort||c&&c.apply(this,arguments)},d.$trans=d.sync(d,a)},abort:function(){this.$trans&&this.$trans.abort&&this.$trans.abort();delete this.$trans;this.$abort=!0},beginTransaction:function(){this.$bakAttrs=f.clone(this.$attrs)},rollbackTransaction:function(){var a=this.$bakAttrs;if(a)this.$attrs=a,delete this.$bakAttrs},endTransaction:function(){delete this.$bakAttrs},lock:function(a){this.hasLocker=
!!a}});return d},{requires:["magix/magix"]});
KISSY.add("mxext/modelfactory",function(f,c){var d=function(b){this.$modelClass=b},a=function(b){if(b._wraped_)return b;var a=function(a){var e=a.success,d=this;d.get("updateIdent")?(a.success=function(){d.set("updateIdent",!1);d._after&&c.safeExec(d._after,d);e&&e.apply(a)},b.call(d,a)):e&&e.apply(a)};a._wraped_=!0;return a};c.mix(d,{mClsCache:{},create:function(b,a){if(!a)throw Error("Factory.create modelClass ungiven");var c=this.mClsCache;b||(b=f.guid());c[b]||(c[b]=new d(a));return c[b]}});c.mix(d.prototype,
{registerModels:function(b){c.isArray(b)||(b=[b]);for(var a=0,d;a<b.length;a++){d=b[a];if(!d.type)throw Error("model must own a type attribute");this[d.type]=d}},fetchModels:function(b,a,d,h){var g=this;if(!g.$modelsCache)g.$modelsCache={};if(!g.$modelsCacheKeys)g.$modelsCacheKeys={};var f=g.$modelsCache,j=g.$modelsCacheKeys;c.isArray(b)||(b=[b]);for(var n=b.length,p=0,s,r=[],v=[],w,t=function(b,k,q,m){p++;if(k)s=m||"fetch data error";else{w=!0;q.set("updateIdent",!1);r[b]=q;if((b=q._cacheKey)&&!c.hasProp(f,
b))f[q._cacheKey]=q,q._after&&c.safeExec(q._after,q);4==h&&a(q)}if((b=q._cacheKey)&&c.hasProp(j,b)){var o=j[b];delete j[b];c.safeExec(o,[k,q,m],q)}4!=h&&p>=n&&(2==h?w?a&&a.apply(g,r):d&&d(s):s?d&&d(s):a&&a.apply(g,r))},x=Array.prototype.slice,u=function(b,a){var c=x.call(arguments,2);return function(){return b.apply(a,c.concat(x.call(arguments)))}},m=0,k;m<b.length;m++){k=b[m];var o=k.cacheKey;o&&c.hasProp(j,o)?j[o].push(u(t,g,m)):(k=g.create(k,!0),k.get("updateIdent")?(v.push(k),o&&(j[o]=[]),k.request({success:u(t,
k,m,!1,k),error:u(t,k,m,!0,k)})):t(m,!1,k))}return{abort:function(){for(var b=0,a;b<v.length;b++){a=v[b];var d=a._cacheKey;if(d&&c.hasProp(j,d)){var e=j[d];delete j[d];c.safeExec(e,[!0,a,"abort"],a)}a.abort()}}}},fetchAll:function(b,a,c){return this.fetchModels(b,a,c,1)},fetchAny:function(b,a,c){return this.fetchModels(b,a,c,2)},fetchOne:function(b,a){return this.fetchModels(b,a,c.noop,4)},getIf:function(b){var a=this.$modelsCache;return a&&c.hasProp(a,b)?a[b]:null},setUpdateIdent:function(b){(b=
this.getIf(b))&&b.set("updateIdent",!0)},create:function(b,d){if(!b.type)throw Error('model must own a "type" attribute');var i=b.type,h=b.cacheKey||i.cacheKey,g;if(!this.$modelsCache)this.$modelsCache={};var f=this.$modelsCache;if(h&&c.hasProp(f,h)){g=f[h];var j=g.get("updateIdent");j&&delete f[h]}else g=new this.$modelClass(i.ops),g._after=i.after,g._cacheKey=h,g.set("updateIdent",!0);if(j=g.get("updateIdent"))g.reset(),g.set(b.ops),g.setParams(i.gets),g.setPostParams(i.posts),g.setParams(b.gets),
g.setPostParams(b.posts),c.isFunction(i.before)&&c.safeExec(i.before,g,i);if(!d)g.request=a(g.request);return g}});return d},{requires:["magix/magix"]});
KISSY.add("mxext/mu",function(f,c){function d(b,c){var d=/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/i,e=b.match(/\{{2,3}[\^#]?if\((.*?)\)\}{2,3}?/ig),f=[];if(e)for(var n=0;n<e.length;n++)f.push(e[n].match(d)[1]);d="";for(e=0;e<f.length;e++)d="if("+f[e]+")",c[d]||(c[d]=a(f[e]))}function a(b){b=b.split("==");return function(){for(var a=b[0].split("."),c=b[1],d=a.length-1;-1<d;d--){var e=a.slice(d),f=this;try{for(var p=0;p<e.length-1;p++)f=f[e[p]];if(e[e.length-1]in f){if(f[e[e.length-1]].toString()===c)return!0;
break}}catch(s){}}return!1}}function b(a,c){var d,e;for(d in a)if(e=a[d],e instanceof Array)for(var f=0;f<e.length;f++){var n=e[f];if("object"==typeof n)0===f?n.__first__=!0:f==e.length-1?n.__last__=!0:n.__mid__=!0,n.__index__=f}else"object"==typeof e&&5>c&&b(e,c+1)}var e=/\s*<script[^>]+type\s*=\s*(['"])\s*text\/tmpl\1[^>]*>([\s\S]*?)<\/script>\s*/gi;return{to_html:function(a,f){"object"==typeof f&&b(f,0);var g=a.match(e);if(g){a=a.replace(e,function(){return'<script type="text/tmpl"><\/script>'});
d(a,f);var a=c.to_html.apply(this,arguments),l=0,a=a.replace(e,function(){return g[l++]})}else d(a,f),a=c.to_html.apply(this,arguments);return a}}},{requires:["mxext/mustache"]});
KISSY.add("mxext/mustache",function(){return function(){var f=function(){};f.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(c,d,a,b){if(!b)this.context=d,this.buffer=[];if(this.includes("",c)){c=this.render_pragmas(c);c=this.render_section(c,d,a);if(b)return this.render_tags(c,d,a,b);this.render_tags(c,d,a,b)}else{if(b)return c;this.send(c)}},send:function(c){""!=c&&this.buffer.push(c)},render_pragmas:function(c){if(!this.includes("%",
c))return c;var d=this;return c.replace(RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),function(a,b,c){if(!d.pragmas_implemented[b])throw{message:"This implementation of mustache doesn't understand the '"+b+"' pragma"};d.pragmas[b]={};c&&(a=c.split("="),d.pragmas[b][a[0]]=a[1]);return""})},render_partial:function(c,d,a){c=this.trim(c);if(!a||void 0===a[c])throw{message:"unknown_partial '"+c+"'"};return"object"!=typeof d[c]?this.render(a[c],d,a,!0):this.render(a[c],d[c],a,!0)},render_section:function(c,
d,a){if(!this.includes("#",c)&&!this.includes("^",c))return c;var b=this;return c.replace(RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),function(c,f,h,g){c=b.find(h,d);if("^"==f)return!c||b.is_array(c)&&0===c.length?b.render(g,d,a,!0):"";if("#"==f)return b.is_array(c)?b.map(c,function(c){return b.render(g,b.create_context(c),a,!0)}).join(""):b.is_object(c)?b.render(g,b.create_context(c),a,!0):"function"===typeof c?c.call(d,g,
function(c){return b.render(c,d,a,!0)}):c?b.render(g,d,a,!0):""})},render_tags:function(c,d,a,b){for(var e=this,f=function(){return RegExp(e.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+e.ctag+"+","g")},h=f(),g=function(b,c,g){switch(c){case "!":return"";case "=":return e.set_delimiters(g),h=f(),"";case ">":return e.render_partial(g,d,a);case "{":return e.find(g,d);default:return e.escape(e.find(g,d))}},c=c.split("\n"),l=0;l<c.length;l++)c[l]=c[l].replace(h,g,this),b||this.send(c[l]);if(b)return c.join("\n")},
set_delimiters:function(c){c=c.split(" ");this.otag=this.escape_regex(c[0]);this.ctag=this.escape_regex(c[1])},escape_regex:function(c){if(!arguments.callee.sRE)arguments.callee.sRE=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","g");return c.replace(arguments.callee.sRE,"\\$1")},find:function(c,d){var c=this.trim(c),a;!1===d[c]||0===d[c]||d[c]?a=d[c]:(!1===this.context[c]||0===this.context[c]||this.context[c])&&(a=this.context[c]);return"function"===typeof a?a.apply(d):void 0!==
a?a:""},includes:function(c,d){return-1!=d.indexOf(this.otag+c)},escape:function(c){return(""+(null===c?"":c)).replace(/&(?!\w+;)|["'<>\\]/g,function(c){switch(c){case "&":return"&amp;";case "\\":return"\\\\";case '"':return"&quot;";case "'":return"&#39;";case "<":return"&lt;";case ">":return"&gt;";default:return c}})},create_context:function(c){if(this.is_object(c))return c;var d=".";if(this.pragmas["IMPLICIT-ITERATOR"])d=this.pragmas["IMPLICIT-ITERATOR"].iterator;var a={};a[d]=c;return a},is_object:function(c){return c&&
"object"==typeof c},is_array:function(c){return"[object Array]"===Object.prototype.toString.call(c)},trim:function(c){return c.replace(/^\s*|\s*$/g,"")},map:function(c,d){if("function"==typeof c.map)return c.map(d);for(var a=[],b=c.length,e=0;e<b;e++)a.push(d(c[e]));return a}};return{name:"mustache.js",version:"0.3.1-dev",to_html:function(c,d,a,b){var e=new f;if(b)e.send=b;e.render(c,d,a);if(!b)return e.buffer.join("\n")}}}()});
KISSY.add("mxext/tmpl",function(){var f={},c={},d="_"+(new Date).getTime(),a=/\s*<script[^>]+type\s*=\s*(['"])\s*text\/tmpl\1[^>]*>([\s\S]*?)<\/script>\s*/gi,b=function(b,a){if(b){var h;h=c[b];h||(h=d+".push('"+b.replace(/\s+/g," ").replace(/<#/g,"\r").replace(/;*#>/g,"\n").replace(/\\(?=[^\r\n]*\n)/g,"\t").replace(/\\/g,"\\\\").replace(/\t/g,"\\").replace(/'(?=[^\r\n]*\n)/g,"\t").replace(/'/g,"\\'").replace(/\t/g,"'").replace(/\r=([^\n]+)\n/g,"',$1,'").replace(/\r/g,"');").replace(/\n/g,";"+d+".push('")+
"');return "+d+".join('')",c[b]=h);var g=[d],l=[[]],j;if(a)for(j in a)g.push(j.replace(/[:+\-*\/&^%#@!~]/g,"$")),l.push(a[j]);j=g.join("_")+"_"+h;if(!f[j])try{f[j]=new Function(g,h)}catch(n){return n.message}try{h=f[j].apply(a,l)}catch(p){h=p.message}return h}return b};return{toHTML:function(c,d){var f=c.match(a);if(f)var c=c.replace(a,function(){return'<script type="text/tmpl"><\/script>'}),c=b(c,d),g=0,c=c.replace(a,function(){return f[g++]});else c=b(c,d);return c}}});
KISSY.add("mxext/vfanim",function(f,c,d){var a=d.config(),b=document,e=a.viewChange,i=d.isFunction(e),h=function(a){return"object"==typeof a?a:b.getElementById(a)};return d.mix(c.prototype,{viewChangeUseAnim:function(){return a.viewChangeAnim},oldViewDestroy:function(){var a=h(this.id),c=h(this.viewId),e=this.view;if(!c){for(c=b.createElement("div");a.firstChild;)c.appendChild(a.firstChild);a.appendChild(c)}c.id="";if(a=e.events)for(var i in a)d.hasProp(a,i)&&f.all("*[mx"+i+"]").removeAttr("mx"+i);
if(!d.hasProp(this,"$animCounter"))this.$animCounter=0;this.$animCounter++;this.$oldViewNode=c},prepareNextView:function(){var a=h(this.id),c=b.createElement("div");c.id=this.viewId;a.insertBefore(c,a.firstChild)},newViewCreated:function(b){var a=this,c=a.$oldViewNode,f=h(a.viewId);i&&d.safeExec(e,{vframeId:a.id,action:b?"viewChange":"viewRefresh",oldViewNode:c,newViewNode:f,collectGarbage:function(){a.$animCounter--;a.$animCounter||delete a.$oldViewNode;try{c.parentNode.removeChild(c)}catch(b){}}},
a)}})},{requires:["magix/vframe","magix/magix","sizzle"]});
KISSY.add("mxext/view",function(f,c,d){return c.extend({queryEvents:null,navigate:function(a){d.navigate(a)},attachQueryEvents:function(){var a=this,b=a.queryEvents;if(b){a.$queryEventsCache={};for(var d in b){var i=b[d],h;for(h in i)f.all("#"+a.id+" "+h).on(d,a.$queryEventsCache[d+"_"+h]=function(d){return function(e){var f=c.idIt(e.target),h=c.idIt(e.currentTarget);Magix.safeExec(d,{view:a,targetId:f,currentId:h,queryEvents:b,domEvent:e},b)}}(i[h]))}}},detachQueryEvents:function(){var a=this.queryEvents;
if(a){for(var b in a){var c=a[b],d;for(d in c)f.all("#"+this.id+" "+d).detach(b,this.$queryEventsCache[b+"_"+d])}delete this.$queryEventsCache}},setData:function(a){this.data=a;for(var b in a)a[b]&&a[b].toJSON&&(a[b]=a[b].toJSON());this.setRenderer()},setRenderer:function(){var a=this,b=this.renderer,c,d;if(b)for(c in b)for(d in b[c])(function(){var f=c,g=d,l=b[f][g];a.data[f+"_"+g]=function(){return l.call(this,a,f)}})()}},function(){var a=this;a.bind("created",function(){a.attachQueryEvents();a.bind("prerender",
function(){a.detachQueryEvents()});a.bind("rendered",function(){a.attachQueryEvents()})})})},{requires:["magix/view","magix/router"]});(function(f){var c=function(){};if(!f.console)f.console={log:c,warn:c,error:c,debug:c};if(!f.Magix)f.Magix={start:function(c){this.$tempCfg=c}},KISSY.use("magix/magix",function(c,a){var b=f.Magix.$tempCfg;f.Magix=a;b&&a.start(b)})})(this);